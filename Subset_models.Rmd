---
title: "Subset models"
author: "Lucy Holland"
date: "2023-10-30"
output: html_document
---
Subset: (1) seasons- Winter and Summer 
```{r subset seasons, include=FALSE}
filtered_data <- read.csv("/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/Enclosure filtered/filtered_data.csv")
#Change the class of the timestamp
filtered_data$t <- as.POSIXct(filtered_data$t, format = "%Y-%m-%d %H:%M:%S")
class(filtered_data$t)
# Create a dataframe for winter
Winter <- filtered_data[filtered_data$SeasonMain == "Winter", ]

# Create a dataframe for summer
Summer <- filtered_data[filtered_data$SeasonMain == "Summer", ]
```
tracks
```{r seasons tracks}
library(dplyr)
library(amt)
library(tidyr)
library(purrr)
library(sf)
#subset winter
winter_tracks <- Winter %>%
dplyr::select(x = longitude, y = latitude,
t = t, id = Collar.ID)
#subset summer
summer_tracks <- Summer %>%
dplyr::select(x = longitude, y = latitude,
t = t, id = Collar.ID)
#remove NAs
summer_tracks <-na.omit(summer_tracks)
winter_tracks <-na.omit(winter_tracks)
#nest by id
nested_winter <- 
  winter_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_winter)

#nest by id
nested_summer <- 
  summer_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))
names(nested_summer)
```
Step lengths
```{r seasons step lengths}
step.lengths.winter <- unlist(map(nested_winter$track, step_lengths))
hist(step.lengths.winter, breaks = 20, main="Histogram of step lengths winter", xlab="Step lengths")
step.lengths.summer <- unlist(map(nested_summer$track, step_lengths))
hist(step.lengths.summer, breaks = 20, main="Histogram of step lengths summer", xlab="Step lengths")
```

```{r season true steps}
true.steps.winter <- map(nested_winter$track, steps)
head(true.steps.winter[[1]])
true.steps.summer <- map(nested_winter$track, steps)
head(true.steps.summer[[1]])
```
Create random steps
Generating 5 random steps per used step.
.id="id" creates a new column with the id of the list so we can still separate data by animal.
```{r season random steps}
true.random.steps.winter <- map(true.steps.winter, random_steps, n=5)
all.steps.winter <- bind_rows(true.random.steps.winter, .id="id")
all.steps.winter
true.random.steps.summer <- map(true.steps.summer, random_steps, n=5)
all.steps.summer <- bind_rows(true.random.steps.summer, .id="id")
all.steps.summer
```
distribution of turning angles for used steps only
```{r}
with(all.steps.winter, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles winter", xlab="turning angle"))
with(all.steps.summer, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles summer", xlab="turning angle"))
```

```{r season clean up}
steps.sp.winter <- all.steps.winter
steps.sp.summer <- all.steps.summer
#remove NA
steps.sp.winter <- na.omit(steps.sp.winter)
steps.sp.summer <- na.omit(steps.sp.summer)
coordinates(steps.sp.winter) <- ~x2_+y2_
proj4string(steps.sp.winter) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
coordinates(steps.sp.summer) <- ~x2_+y2_
proj4string(steps.sp.summer) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
```
Extract habitat covariate data
Winter
```{r winter covariate extraction}
winter_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.winter)
winter_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.winter)
winter_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.winter)
winter_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.winter)
winter_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.winter)
winter_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.winter)
winter_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.winter)
winter_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.winter)
winter_elevation <- raster::extract(elevation_scaled, steps.sp.winter)
winter_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.winter)
winter_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.winter)
winter_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.winter)
winter_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.winter)
winter_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.winter)
winter_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.winter)
winter_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.winter)
winter_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.winter)

covariates_winter <- cbind(winter_distance_to_roads,winter_distance_to_forest_edge,winter_distance_to_riparian,winter_distance_to_release_sites,winter_NDVI_aug20,winter_NDVI_mar21,winter_NDWI_aug20,winter_NDWI_mar21,winter_elevation,winter_TRI_50,winter_broad_2000,winter_mixed_2000,winter_ngrass_2000,winter_hm_grass_2000,winter_transitional_2000,winter_aspect_2000,winter_slope_500)
```
Summer
```{r summer covarate extraction}
summer_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.summer)
summer_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.summer)
summer_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.summer)
summer_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.summer)
summer_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.summer)
summer_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.summer)
summer_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.summer)
summer_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.summer)
summer_elevation <- raster::extract(elevation_scaled, steps.sp.summer)
summer_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.summer)
summer_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.summer)
summer_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.summer)
summer_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.summer)
summer_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.summer)
summer_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.summer)
summer_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.summer)
summer_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.summer)

covariates_summer <- cbind(summer_distance_to_roads,summer_distance_to_forest_edge,summer_distance_to_riparian,summer_distance_to_release_sites,summer_NDVI_aug20,summer_NDVI_mar21,summer_NDWI_aug20,summer_NDWI_mar21,summer_elevation,summer_TRI_50,summer_broad_2000,summer_mixed_2000,summer_ngrass_2000,summer_hm_grass_2000,summer_transitional_2000,summer_aspect_2000,summer_slope_500)
```
add the covariate data to our SpatialPointsDataFrame of used and random steps
```{r winter spatial df}
steps.sp.winter$winter_distance_to_roads <- covariates_winter[,1]
steps.sp.winter$winter_distance_to_forest_edge <- covariates_winter[,2]
steps.sp.winter$winter_distance_to_riparian <- covariates_winter[,3]
steps.sp.winter$winter_distance_to_release_sites <- covariates_winter[,4]
steps.sp.winter$winter_NDVI_aug20 <- covariates_winter[,5]
steps.sp.winter$winter_NDVI_mar21 <- covariates_winter[,6]
steps.sp.winter$winter_NDWI_aug20 <- covariates_winter[,7]
steps.sp.winter$winter_NDWI_mar21 <- covariates_winter[,8]
steps.sp.winter$winter_elevation <- covariates_winter[,9]
steps.sp.winter$winter_TRI_50 <- covariates_winter[,10]
steps.sp.winter$winter_broad_2000 <- covariates_winter[,11]
steps.sp.winter$winter_mixed_2000 <- covariates_winter[,12]
steps.sp.winter$winter_ngrass_2000 <- covariates_winter[,13]
steps.sp.winter$winter_hm_grass_2000 <- covariates_winter[,14]
steps.sp.winter$winter_transitional_2000 <- covariates_winter[,15]
steps.sp.winter$winter_aspect_2000 <- covariates_winter[,16]
steps.sp.winter$winter_slope_500 <- covariates_winter[,17]

head(steps.sp.winter)
```
Summer
```{r summer spatial df}
steps.sp.summer$summer_distance_to_roads <- covariates_summer[,1]
steps.sp.summer$summer_distance_to_forest_edge <- covariates_summer[,2]
steps.sp.summer$summer_distance_to_riparian <- covariates_summer[,3]
steps.sp.summer$summer_distance_to_release_sites <- covariates_summer[,4]
steps.sp.summer$summer_NDVI_aug20 <- covariates_summer[,5]
steps.sp.summer$summer_NDVI_mar21 <- covariates_summer[,6]
steps.sp.summer$summer_NDWI_aug20 <- covariates_summer[,7]
steps.sp.summer$summer_NDWI_mar21 <- covariates_summer[,8]
steps.sp.summer$summer_elevation <- covariates_summer[,9]
steps.sp.summer$summer_TRI_50 <- covariates_summer[,10]
steps.sp.summer$summer_broad_2000 <- covariates_summer[,11]
steps.sp.summer$summer_mixed_2000 <- covariates_summer[,12]
steps.sp.summer$summer_ngrass_2000 <- covariates_summer[,13]
steps.sp.summer$summer_hm_grass_2000 <- covariates_summer[,14]
steps.sp.summer$summer_transitional_2000 <- covariates_summer[,15]
steps.sp.summer$summer_aspect_2000 <- covariates_summer[,16]
steps.sp.summer$summer_slope_500 <- covariates_summer[,17]

head(steps.sp.summer)
```
```{r}
#Export
write.csv(steps.sp.summer, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.summer.csv", row.names = FALSE)
write.csv(steps.sp.winter, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.winter.csv", row.names = FALSE)
```

Models
Winter
```{r winter models}
library(survival)
#distance to riparian and distance to forest
wintermod1 <- survival::clogit(case_ ~ winter_distance_to_riparian + winter_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
coef(wintermod1)
#Distance to roads + distance to forests
wintermod2 <- survival::clogit(case_ ~winter_distance_to_roads + winter_distance_to_forest_edge + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#Distance to rip + distance to forests + distance to roads
wintermod3 <- survival::clogit(case_ ~winter_distance_to_riparian + winter_distance_to_roads + winter_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
##Distance to rip and distance to forests interaction with  distance to roads
wintermod3.i <- survival::clogit(case_ ~winter_distance_to_riparian*winter_distance_to_forest_edge + winter_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#Distance to rip + distance to forests + distance to release sites 
wintermod4 <- survival::clogit(case_ ~ winter_distance_to_riparian + winter_distance_to_release_sites + winter_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI + NDWI winter
wintermod5 <- survival::clogit(case_ ~winter_NDVI_aug20 + winter_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI + NDWI march
wintermod6 <- survival::clogit(case_ ~ winter_NDVI_mar21 + winter_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI + elevation winter
wintermod7 <- survival::clogit(case_ ~ winter_NDVI_aug20 + winter_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI elevation interaction
wintermod7.i <- survival::clogit(case_ ~ winter_NDVI_aug20*winter_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI and elevation winter
wintermod8 <- survival::clogit(case_ ~ winter_NDVI_mar21 + winter_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI and elevation interaction winter
wintermod8.i <- survival::clogit(case_ ~ winter_NDVI_mar21*winter_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI + broad + mixed winter
wintermod9 <- survival::clogit(case_ ~ winter_NDVI_aug20 + winter_broad_2000 + winter_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI and broad interaction with mixed winter
wintermod9.i<- survival::clogit(case_ ~ winter_NDVI_aug20*winter_broad_2000 + winter_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI and mixed interaction with broad winter
wintermod9.ii<- survival::clogit(case_ ~ winter_NDVI_aug20*winter_mixed_2000 + winter_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI + broad + mixed winter
wintermod10 <- survival::clogit(case_ ~ winter_NDVI_mar21 + winter_broad_2000 + winter_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI and broad interaction with mixed winter
wintermod10.i<- survival::clogit(case_ ~ winter_NDVI_mar21*winter_broad_2000 + winter_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#NDVI and mixed interaction with broad winter
wintermod10.ii<- survival::clogit(case_ ~ winter_NDVI_mar21*winter_mixed_2000 + winter_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#broad and mixed
wintermod11 <- survival::clogit(case_ ~ winter_broad_2000 + winter_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#Natural grassland +hm grassland
wintermod12 <- survival::clogit(case_ ~ winter_ngrass_2000 + winter_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#natural grassland and human managed grassland interaction
wintermod12.i <- survival::clogit(case_ ~ winter_ngrass_2000*winter_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#Mixed forest+ transition habitat
wintermod13 <- survival::clogit(case_ ~ winter_mixed_2000 + winter_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#Broad + mixed + natgrass + hmgrass + transitional
wintermod14 <- survival::clogit(case_ ~ winter_broad_2000 + winter_mixed_2000 + winter_ngrass_2000 + winter_hm_grass_2000 + winter_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#broad and mixed interaction with natural grasslands and human managed grassland
wintermod14.i <- survival::clogit(case_ ~ winter_broad_2000*winter_mixed_2000 + winter_ngrass_2000 + winter_hm_grass_2000 + winter_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#natural grasslands and human managed grasslands interaction with broad and mixed
wintermod14.ii <- survival::clogit(case_ ~ winter_broad_2000 + winter_mixed_2000 + winter_ngrass_2000*winter_hm_grass_2000 + winter_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
wintermod15 <- survival::clogit(case_ ~ winter_broad_2000 + winter_mixed_2000 + winter_ngrass_2000 + winter_hm_grass_2000 + winter_transitional_2000 + winter_distance_to_riparian + winter_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#Broad + mixed + distance to roads
wintermod16 <- survival::clogit(case_ ~ winter_broad_2000 + winter_mixed_2000 + winter_distance_to_roads + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#TRI + slope + elevation + aspect
wintermod17 <- survival::clogit(case_ ~ winter_TRI_50 + winter_slope_500 + winter_elevation + winter_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#TRI and elevation interaction with slope + aspect
wintermod17.i <- survival::clogit(case_ ~ winter_TRI_50*winter_elevation + winter_slope_500 + winter_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#TRI + slope + elevation + aspect + ndvi + ndwi
wintermod18 <- survival::clogit(case_ ~ winter_TRI_50 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_aug20 + winter_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#TRI + slope + elevation + aspect + NDVI winter + NDWI winter
wintermod19 <- survival::clogit(case_ ~ winter_TRI_50 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#TRI + slope + elevation + aspect +forest mixed + forest broad
wintermod20 <- survival::clogit(case_ ~ winter_TRI_50 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_mixed_2000 + winter_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#forest edge and roads
wintermod21 <- survival::clogit(case_ ~  winter_distance_to_forest_edge*winter_distance_to_roads + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
summary(wintermod21)
#forest edge and broad
wintermod22 <- survival::clogit(case_ ~ winter_distance_to_forest_edge + winter_broad_2000 + winter_distance_to_forest_edge*winter_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#riparian zones and elevation
wintermod23 <- survival::clogit(case_ ~ winter_distance_to_riparian + winter_elevation + winter_distance_to_riparian* winter_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#broadleaf forest and elevation (with TRI and NDVI)
wintermod24 <- survival::clogit(case_ ~ winter_broad_2000*winter_elevation + winter_TRI_50 + winter_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
wintermod24.1 <- survival::clogit(case_ ~ winter_broad_2000*winter_elevation + winter_TRI_50 + winter_NDVI_aug20 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#natural grasslands and distance to forest edge (with NDVI and elevation)
wintermod25 <- survival::clogit(case_ ~ winter_ngrass_2000*winter_distance_to_forest_edge + winter_NDVI_mar21 + winter_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#transitional and distance to forest edge (with elevation and aspect and TRI)
wintermod26 <- survival::clogit(case_ ~ winter_transitional_2000*winter_distance_to_forest_edge + winter_elevation + winter_aspect_2000 + winter_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#transitional and mixed forest (with broadleaf and elevation)
wintermod27 <- survival::clogit(case_ ~ winter_transitional_2000*winter_mixed_2000 + winter_elevation + winter_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#transitional and broadleaf (with mixed and elevation)
wintermod28 <- survival::clogit(case_ ~ winter_transitional_2000*winter_broad_2000 + winter_elevation + winter_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to roads and broadleaf (with NDVI and elevation)
wintermod29 <- survival::clogit(case_ ~ winter_distance_to_roads*winter_broad_2000 + winter_elevation + winter_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to roads and mixed (with NDVI and elevation)
wintermod30 <- survival::clogit(case_ ~ winter_distance_to_roads*winter_mixed_2000 + winter_elevation + winter_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
wintermod31 <- survival::clogit(case_ ~ winter_distance_to_roads*winter_ngrass_2000 + winter_elevation + winter_NDVI_mar21 + winter_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
wintermod32 <- survival::clogit(case_ ~ winter_distance_to_roads*winter_transitional_2000 + winter_elevation + winter_NDVI_mar21 + winter_TRI_50 + winter_ngrass_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
wintermod33 <- survival::clogit(case_ ~ winter_distance_to_release_sites*winter_ngrass_2000 + winter_broad_2000 + winter_NDVI_mar21 + winter_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
wintermod34 <- survival::clogit(case_ ~ winter_distance_to_release_sites*winter_broad_2000 + winter_ngrass_2000 + winter_NDVI_mar21 + winter_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to release sites and mixed (with grasslands, broad and NDVI)
wintermod35 <- survival::clogit(case_ ~ winter_distance_to_release_sites*winter_mixed_2000 + winter_ngrass_2000 + winter_NDVI_mar21 + winter_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and broadleaf (with wintermod19-slope, elevation, aspect, NDVI and NDWI)
wintermod36 <- survival::clogit(case_ ~ winter_TRI_50*winter_broad_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and natgrasslands (with wintermod19-slope, elevation, aspect, NDVI and NDWI)
wintermod37 <- survival::clogit(case_ ~ winter_TRI_50*winter_ngrass_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and mixed (with wintermod19-slope, elevation, aspect, NDVI and NDWI)
wintermod38 <- survival::clogit(case_ ~ winter_TRI_50*winter_mixed_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and transitional habitat (with wintermod19-slope, elevation, aspect, NDVI and NDWI)
wintermod39 <- survival::clogit(case_ ~ winter_TRI_50*winter_transitional_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to forest edge and NDVI (with elevation, slope and TRI)
wintermod40 <- survival::clogit(case_ ~ winter_distance_to_forest_edge*winter_NDVI_mar21 + winter_slope_500 + winter_elevation + winter_TRI_50 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to release sites and TRI (with aspect, elevation and slope)
wintermod41 <- survival::clogit(case_ ~ winter_distance_to_release_sites*winter_TRI_50 + winter_slope_500 + winter_elevation + winter_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to release sites and elevation (with aspect, TRI and slope)
wintermod42 <- survival::clogit(case_ ~ winter_distance_to_release_sites*winter_elevation + winter_slope_500 + winter_TRI_50 + winter_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
wintermod43 <- survival::clogit(case_ ~ winter_distance_to_forest_edge*winter_broad_2000 + winter_mixed_2000 + winter_NDVI_mar21 + winter_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
wintermod44 <- survival::clogit(case_ ~ winter_distance_to_forest_edge*winter_mixed_2000 + winter_broad_2000 + winter_NDVI_mar21 + winter_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
#Elevation and TRI (with ndvi, slope and aspect)
wintermod45 <- survival::clogit(case_ ~ winter_elevation*winter_TRI_50+ winter_broad_2000 + winter_NDVI_mar21 + winter_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
wintermod46 <- survival::clogit(case_ ~ winter_TRI_50*winter_broad_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + winter_distance_to_forest_edge + winter_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
wintermod47 <- survival::clogit(case_ ~ winter_TRI_50*winter_ngrass_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + winter_distance_to_forest_edge + winter_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
wintermod48 <- survival::clogit(case_ ~ winter_TRI_50*winter_mixed_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + winter_distance_to_forest_edge + winter_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
wintermod49 <- survival::clogit(case_ ~ winter_TRI_50*winter_transitional_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21+ winter_distance_to_forest_edge + winter_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
wintermod50 <- survival::clogit(case_ ~ winter_TRI_50*winter_broad_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + winter_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
wintermod51 <- survival::clogit(case_ ~ winter_TRI_50*winter_ngrass_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + winter_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
wintermod52 <- survival::clogit(case_ ~ winter_TRI_50*winter_mixed_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21 + winter_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
wintermod53 <- survival::clogit(case_ ~ winter_TRI_50*winter_transitional_2000 + winter_slope_500 + winter_elevation + winter_aspect_2000 + winter_NDVI_mar21 + winter_NDWI_mar21+ winter_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.winter)
summary(wintermod1)
summary(wintermod2)
summary(wintermod3)
summary(wintermod3.i)
summary(wintermod4)
summary(wintermod5)
summary(wintermod6)
summary(wintermod7)
summary(wintermod8)
summary(wintermod8.i)
summary(wintermod9)
summary(wintermod9.i)
summary(wintermod9.ii)
summary(wintermod10)
summary(wintermod10.i)
summary(wintermod10.ii)
summary(wintermod11)
summary(wintermod12)
summary(wintermod12.i)
summary(wintermod13)
summary(wintermod14)
summary(wintermod14.i)
summary(wintermod14.ii)
summary(wintermod15)
summary(wintermod16)
summary(wintermod17)
summary(wintermod17.i)
summary(wintermod18)
summary(wintermod19)
summary(wintermod20)
summary(wintermod21)
summary(wintermod22)
summary(wintermod23)
summary(wintermod24)
summary(wintermod25)
summary(wintermod26)
summary(wintermod27)
summary(wintermod28)
summary(wintermod29)
summary(wintermod30)
summary(wintermod31)
summary(wintermod32)
summary(wintermod33)
summary(wintermod34)
summary(wintermod35)
summary(wintermod36)
summary(wintermod37)
summary(wintermod38)
summary(wintermod39)
summary(wintermod40)
summary(wintermod41)
summary(wintermod42)
summary(wintermod43)
summary(wintermod44)
summary(wintermod45)
summary(wintermod46)
summary(wintermod47)
summary(wintermod48)
summary(wintermod49)
summary(wintermod50)
summary(wintermod51)
summary(wintermod52)
summary(wintermod53)
```

AIC
```{r winter AIC}
wintermodsel <- model.sel(wintermod1,wintermod2,wintermod3,wintermod3.i,wintermod4,wintermod5,wintermod6,wintermod7,wintermod8,wintermod8.i,wintermod9,wintermod9.i,wintermod9.ii,wintermod10,wintermod10.i,wintermod10.ii,wintermod11,wintermod12,wintermod12.i,wintermod13,wintermod14,wintermod14.i,wintermod14.ii,wintermod15,wintermod16,wintermod17,wintermod17.i,wintermod18,wintermod19,wintermod20,wintermod21, wintermod22, wintermod23, wintermod24, wintermod25, wintermod26, wintermod27, wintermod28,wintermod29,wintermod30,wintermod31,wintermod32,wintermod33,wintermod34,wintermod35,wintermod36,wintermod37,wintermod38,wintermod39,wintermod40,wintermod41,wintermod42,wintermod43,wintermod44,wintermod45,wintermod46,wintermod47,wintermod48,wintermod49,wintermod50,wintermod51,wintermod52,wintermod53)
wintermodsel #wintermod48 and 52
#top 5 further model selection
wintermodselsub <- model.sel(wintermod48,wintermod52,wintermod38,wintermod48,wintermod51)
```
Models
summer
```{r summer models}
#distance to riparian and distance to forest
summermod1 <- survival::clogit(case_ ~ summer_distance_to_riparian + summer_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
coef(summermod1)
#Distance to roads + distance to forests
summermod2 <- survival::clogit(case_ ~summer_distance_to_roads + summer_distance_to_forest_edge + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#Distance to rip + distance to forests + distance to roads
summermod3 <- survival::clogit(case_ ~summer_distance_to_riparian + summer_distance_to_roads + summer_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
##Distance to rip and distance to forests interaction with  distance to roads
summermod3.i <- survival::clogit(case_ ~summer_distance_to_riparian*summer_distance_to_forest_edge + summer_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#Distance to rip + distance to forests + distance to release sites 
summermod4 <- survival::clogit(case_ ~ summer_distance_to_riparian + summer_distance_to_release_sites + summer_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI + NDWI summer
summermod5 <- survival::clogit(case_ ~summer_NDVI_aug20 + summer_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI + NDWI march
summermod6 <- survival::clogit(case_ ~ summer_NDVI_mar21 + summer_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI + elevation summer
summermod7 <- survival::clogit(case_ ~ summer_NDVI_aug20 + summer_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI elevation interaction
summermod7.i <- survival::clogit(case_ ~ summer_NDVI_aug20*summer_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI and elevation summer
summermod8 <- survival::clogit(case_ ~ summer_NDVI_mar21 + summer_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI and elevation interaction summer
summermod8.i <- survival::clogit(case_ ~ summer_NDVI_mar21*summer_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI + broad + mixed summer
summermod9 <- survival::clogit(case_ ~ summer_NDVI_aug20 + summer_broad_2000 + summer_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI and broad interaction with mixed summer
summermod9.i<- survival::clogit(case_ ~ summer_NDVI_aug20*summer_broad_2000 + summer_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI and mixed interaction with broad summer
summermod9.ii<- survival::clogit(case_ ~ summer_NDVI_aug20*summer_mixed_2000 + summer_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI + broad + mixed summer
summermod10 <- survival::clogit(case_ ~ summer_NDVI_mar21 + summer_broad_2000 + summer_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI and broad interaction with mixed summer
summermod10.i<- survival::clogit(case_ ~ summer_NDVI_mar21*summer_broad_2000 + summer_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#NDVI and mixed interaction with broad summer
summermod10.ii<- survival::clogit(case_ ~ summer_NDVI_mar21*summer_mixed_2000 + summer_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#broad and mixed
summermod11 <- survival::clogit(case_ ~ summer_broad_2000 + summer_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#Natural grassland +hm grassland
summermod12 <- survival::clogit(case_ ~ summer_ngrass_2000 + summer_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#natural grassland and human managed grassland interaction
summermod12.i <- survival::clogit(case_ ~ summer_ngrass_2000*summer_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#Mixed forest+ transition habitat
summermod13 <- survival::clogit(case_ ~ summer_mixed_2000 + summer_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#Broad + mixed + natgrass + hmgrass + transitional
summermod14 <- survival::clogit(case_ ~ summer_broad_2000 + summer_mixed_2000 + summer_ngrass_2000 + summer_hm_grass_2000 + summer_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#broad and mixed interaction with natural grasslands and human managed grassland
summermod14.i <- survival::clogit(case_ ~ summer_broad_2000*summer_mixed_2000 + summer_ngrass_2000 + summer_hm_grass_2000 + summer_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#natural grasslands and human managed grasslands interaction with broad and mixed
summermod14.ii <- survival::clogit(case_ ~ summer_broad_2000 + summer_mixed_2000 + summer_ngrass_2000*summer_hm_grass_2000 + summer_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
summermod15 <- survival::clogit(case_ ~ summer_broad_2000 + summer_mixed_2000 + summer_ngrass_2000 + summer_hm_grass_2000 + summer_transitional_2000 + summer_distance_to_riparian + summer_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#Broad + mixed + distance to roads
summermod16 <- survival::clogit(case_ ~ summer_broad_2000 + summer_mixed_2000 + summer_distance_to_roads + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#TRI + slope + elevation + aspect
summermod17 <- survival::clogit(case_ ~ summer_TRI_50 + summer_slope_500 + summer_elevation + summer_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#TRI and elevation interaction with slope + aspect
summermod17.i <- survival::clogit(case_ ~ summer_TRI_50*summer_elevation + summer_slope_500 + summer_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#TRI + slope + elevation + aspect + ndvi + ndwi
summermod18 <- survival::clogit(case_ ~ summer_TRI_50 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_aug20 + summer_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#TRI + slope + elevation + aspect + NDVI summer + NDWI summer
summermod19 <- survival::clogit(case_ ~ summer_TRI_50 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#TRI + slope + elevation + aspect +forest mixed + forest broad
summermod20 <- survival::clogit(case_ ~ summer_TRI_50 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_mixed_2000 + summer_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#forest edge and roads
summermod21 <- survival::clogit(case_ ~  summer_distance_to_forest_edge*summer_distance_to_roads + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
summary(summermod21)
#forest edge and broad
summermod22 <- survival::clogit(case_ ~ summer_distance_to_forest_edge + summer_broad_2000 + summer_distance_to_forest_edge*summer_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#riparian zones and elevation
summermod23 <- survival::clogit(case_ ~ summer_distance_to_riparian + summer_elevation + summer_distance_to_riparian* summer_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#broadleaf forest and elevation (with TRI and NDVI)
summermod24 <- survival::clogit(case_ ~ summer_broad_2000*summer_elevation + summer_TRI_50 + summer_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
summermod24.1 <- survival::clogit(case_ ~ summer_broad_2000*summer_elevation + summer_TRI_50 + summer_NDVI_aug20 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#natural grasslands and distance to forest edge (with NDVI and elevation)
summermod25 <- survival::clogit(case_ ~ summer_ngrass_2000*summer_distance_to_forest_edge + summer_NDVI_mar21 + summer_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#transitional and distance to forest edge (with elevation and aspect and TRI)
summermod26 <- survival::clogit(case_ ~ summer_transitional_2000*summer_distance_to_forest_edge + summer_elevation + summer_aspect_2000 + summer_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#transitional and mixed forest (with broadleaf and elevation)
summermod27 <- survival::clogit(case_ ~ summer_transitional_2000*summer_mixed_2000 + summer_elevation + summer_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#transitional and broadleaf (with mixed and elevation)
summermod28 <- survival::clogit(case_ ~ summer_transitional_2000*summer_broad_2000 + summer_elevation + summer_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to roads and broadleaf (with NDVI and elevation)
summermod29 <- survival::clogit(case_ ~ summer_distance_to_roads*summer_broad_2000 + summer_elevation + summer_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to roads and mixed (with NDVI and elevation)
summermod30 <- survival::clogit(case_ ~ summer_distance_to_roads*summer_mixed_2000 + summer_elevation + summer_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
summermod31 <- survival::clogit(case_ ~ summer_distance_to_roads*summer_ngrass_2000 + summer_elevation + summer_NDVI_mar21 + summer_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
summermod32 <- survival::clogit(case_ ~ summer_distance_to_roads*summer_transitional_2000 + summer_elevation + summer_NDVI_mar21 + summer_TRI_50 + summer_ngrass_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
summermod33 <- survival::clogit(case_ ~ summer_distance_to_release_sites*summer_ngrass_2000 + summer_broad_2000 + summer_NDVI_mar21 + summer_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
summermod34 <- survival::clogit(case_ ~ summer_distance_to_release_sites*summer_broad_2000 + summer_ngrass_2000 + summer_NDVI_mar21 + summer_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to release sites and mixed (with grasslands, broad and NDVI)
summermod35 <- survival::clogit(case_ ~ summer_distance_to_release_sites*summer_mixed_2000 + summer_ngrass_2000 + summer_NDVI_mar21 + summer_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and broadleaf (with summermod19-slope, elevation, aspect, NDVI and NDWI)
summermod36 <- survival::clogit(case_ ~ summer_TRI_50*summer_broad_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and natgrasslands (with summermod19-slope, elevation, aspect, NDVI and NDWI)
summermod37 <- survival::clogit(case_ ~ summer_TRI_50*summer_ngrass_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and mixed (with summermod19-slope, elevation, aspect, NDVI and NDWI)
summermod38 <- survival::clogit(case_ ~ summer_TRI_50*summer_mixed_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and transitional habitat (with summermod19-slope, elevation, aspect, NDVI and NDWI)
summermod39 <- survival::clogit(case_ ~ summer_TRI_50*summer_transitional_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to forest edge and NDVI (with elevation, slope and TRI)
summermod40 <- survival::clogit(case_ ~ summer_distance_to_forest_edge*summer_NDVI_mar21 + summer_slope_500 + summer_elevation + summer_TRI_50 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to release sites and TRI (with aspect, elevation and slope)
summermod41 <- survival::clogit(case_ ~ summer_distance_to_release_sites*summer_TRI_50 + summer_slope_500 + summer_elevation + summer_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to release sites and elevation (with aspect, TRI and slope)
summermod42 <- survival::clogit(case_ ~ summer_distance_to_release_sites*summer_elevation + summer_slope_500 + summer_TRI_50 + summer_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
summermod43 <- survival::clogit(case_ ~ summer_distance_to_forest_edge*summer_broad_2000 + summer_mixed_2000 + summer_NDVI_mar21 + summer_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
summermod44 <- survival::clogit(case_ ~ summer_distance_to_forest_edge*summer_mixed_2000 + summer_broad_2000 + summer_NDVI_mar21 + summer_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
#Elevation and TRI (with ndvi, slope and aspect)
summermod45 <- survival::clogit(case_ ~ summer_elevation*summer_TRI_50+ summer_broad_2000 + summer_NDVI_mar21 + summer_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
summermod46 <- survival::clogit(case_ ~ summer_TRI_50*summer_broad_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + summer_distance_to_forest_edge + summer_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
summermod47 <- survival::clogit(case_ ~ summer_TRI_50*summer_ngrass_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + summer_distance_to_forest_edge + summer_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
summermod48 <- survival::clogit(case_ ~ summer_TRI_50*summer_mixed_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + summer_distance_to_forest_edge + summer_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
summermod49 <- survival::clogit(case_ ~ summer_TRI_50*summer_transitional_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21+ summer_distance_to_forest_edge + summer_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
summermod50 <- survival::clogit(case_ ~ summer_TRI_50*summer_broad_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + summer_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
summermod51 <- survival::clogit(case_ ~ summer_TRI_50*summer_ngrass_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + summer_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
summermod52 <- survival::clogit(case_ ~ summer_TRI_50*summer_mixed_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21 + summer_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
summermod53 <- survival::clogit(case_ ~ summer_TRI_50*summer_transitional_2000 + summer_slope_500 + summer_elevation + summer_aspect_2000 + summer_NDVI_mar21 + summer_NDWI_mar21+ summer_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.summer)
summary(summermod1)
summary(summermod2)
summary(summermod3)
summary(summermod3.i)
summary(summermod4)
summary(summermod5)
summary(summermod6)
summary(summermod7)
summary(summermod8)
summary(summermod8.i)
summary(summermod9)
summary(summermod9.i)
summary(summermod9.ii)
summary(summermod10)
summary(summermod10.i)
summary(summermod10.ii)
summary(summermod11)
summary(summermod12)
summary(summermod12.i)
summary(summermod13)
summary(summermod14)
summary(summermod14.i)
summary(summermod14.ii)
summary(summermod15)
summary(summermod16)
summary(summermod17)
summary(summermod17.i)
summary(summermod18)
summary(summermod19)
summary(summermod20)
summary(summermod21)
summary(summermod22)
summary(summermod23)
summary(summermod24)
summary(summermod25)
summary(summermod26)
summary(summermod27)
summary(summermod28)
summary(summermod29)
summary(summermod30)
summary(summermod31)
summary(summermod32)
summary(summermod33)
summary(summermod34)
summary(summermod35)
summary(summermod36)
summary(summermod37)
summary(summermod38)
summary(summermod39)
summary(summermod40)
summary(summermod41)
summary(summermod42)
summary(summermod43)
summary(summermod44)
summary(summermod45)
summary(summermod46)
summary(summermod47)
summary(summermod48)
summary(summermod49)
summary(summermod50)
summary(summermod51)
summary(summermod52)
summary(summermod53)
```

AIC
```{r summer AIC}
summermodsel <- model.sel(summermod1,summermod2,summermod3,summermod3.i,summermod4,summermod5,summermod6,summermod7,summermod8,summermod8.i,summermod9,summermod9.i,summermod9.ii,summermod10,summermod10.i,summermod10.ii,summermod11,summermod12,summermod12.i,summermod13,summermod14,summermod14.i,summermod14.ii,summermod15,summermod16,summermod17,summermod17.i,summermod18,summermod19,summermod20,summermod21, summermod22, summermod23, summermod24, summermod25, summermod26, summermod27, summermod28,summermod29,summermod30,summermod31,summermod32,summermod33,summermod34,summermod35,summermod36,summermod37,summermod38,summermod39,summermod40,summermod41,summermod42,summermod43,summermod44,summermod45,summermod46,summermod47,summermod48,summermod49,summermod50,summermod51,summermod52,summermod53)
summermodsel #summermod48 and 52
#top 5 further model selection
summermodselsub <- model.sel(summermod48,summermod52,summermod38,summermod46,summermod47)
```
(2) subset: herd
```{r subset herd}
View(filtered_data)
unique(filtered_data$Herd)
# Create a dataframe for Bunea(all)
Bunea <- filtered_data[filtered_data$Herd %in% c("Bunea I", "Bunea II", "Bunea III"), ]
# Create a dataframe for Bunea I
BuneaI <- filtered_data[filtered_data$Herd %in% c("Bunea I", "Bunea III"), ]
# Create a dataframe for Bunea II
BuneaII <- filtered_data[filtered_data$Herd %in% c("Bunea II", "Bunea IV"), ]
# Create a dataframe for Bunea(all)
Leresti <- filtered_data[filtered_data$Herd %in% c("Leresti I", "Leresti II"), ]
# Create a dataframe for Bunea I
LerestiI <- filtered_data[filtered_data$Herd == "Leresti I", ]
# Create a dataframe for Bunea II
LerestiII <- filtered_data[filtered_data$Herd == "Leresti II", ]
```
tracks
```{r herd tracks}
#subset bunea
bunea_tracks <- Bunea %>%
  dplyr::select(x = longitude, y = latitude,
                t = t, id = Collar.ID)
#subset leresti
leresti_tracks <- Leresti %>%
  dplyr::select(x = longitude, y = latitude,
                t = t, id = Collar.ID)
#remove NAs
leresti_tracks <-na.omit(leresti_tracks)
bunea_tracks <-na.omit(bunea_tracks)
#nest by id
nested_bunea <- 
  bunea_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_bunea)
#nest by id
nested_leresti <- 
  leresti_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_leresti)
```
Step lengths
```{r herd step lengths}
step.lengths.bunea <- unlist(map(nested_bunea$track, step_lengths))
hist(step.lengths.bunea, breaks = 20, main="Histogram of step lengths bunea", xlab="Step lengths")
step.lengths.leresti <- unlist(map(nested_leresti$track, step_lengths))
hist(step.lengths.leresti, breaks = 20, main="Histogram of step lengths leresti", xlab="Step lengths")
```

```{r herd true steps}
true.steps.bunea <- map(nested_bunea$track, steps)
head(true.steps.bunea[[1]])
true.steps.leresti <- map(nested_bunea$track, steps)
head(true.steps.leresti[[1]])
```
Create random steps
Generating 5 random steps per used step.
.id="id" creates a new column with the id of the list so we can still separate data by animal.
```{r herd random steps}
true.random.steps.bunea <- map(true.steps.bunea, random_steps, n=5)
all.steps.bunea <- bind_rows(true.random.steps.bunea, .id="id")
all.steps.bunea
true.random.steps.leresti <- map(true.steps.leresti, random_steps, n=5)
all.steps.leresti <- bind_rows(true.random.steps.leresti, .id="id")
all.steps.leresti
```
distribution of turning angles for used steps only
```{r herd turning angles}
with(all.steps.bunea, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles bunea", xlab="turning angle"))
with(all.steps.leresti, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles leresti", xlab="turning angle"))
```

```{r herd clean up}
steps.sp.bunea <- all.steps.bunea
steps.sp.leresti <- all.steps.leresti
#remove NA
steps.sp.bunea <- na.omit(steps.sp.bunea)
steps.sp.leresti <- na.omit(steps.sp.leresti)
coordinates(steps.sp.bunea) <- ~x2_+y2_
proj4string(steps.sp.bunea) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
coordinates(steps.sp.leresti) <- ~x2_+y2_
proj4string(steps.sp.leresti) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
```
Extract habitat covariate data
bunea
```{r bunea covariate extraction}
bunea_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.bunea)
bunea_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.bunea)
bunea_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.bunea)
bunea_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.bunea)
bunea_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.bunea)
bunea_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.bunea)
bunea_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.bunea)
bunea_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.bunea)
bunea_elevation <- raster::extract(elevation_scaled, steps.sp.bunea)
bunea_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.bunea)
bunea_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.bunea)
bunea_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.bunea)
bunea_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.bunea)
bunea_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.bunea)
bunea_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.bunea)
bunea_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.bunea)
bunea_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.bunea)

covariates_bunea <- cbind(bunea_distance_to_roads,bunea_distance_to_forest_edge,bunea_distance_to_riparian,bunea_distance_to_release_sites,bunea_NDVI_aug20,bunea_NDVI_mar21,bunea_NDWI_aug20,bunea_NDWI_mar21,bunea_elevation,bunea_TRI_50,bunea_broad_2000,bunea_mixed_2000,bunea_ngrass_2000,bunea_hm_grass_2000,bunea_transitional_2000,bunea_aspect_2000,bunea_slope_500)
```
leresti
```{r leresti covariate extraction}
leresti_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.leresti)
leresti_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.leresti)
leresti_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.leresti)
leresti_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.leresti)
leresti_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.leresti)
leresti_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.leresti)
leresti_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.leresti)
leresti_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.leresti)
leresti_elevation <- raster::extract(elevation_scaled, steps.sp.leresti)
leresti_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.leresti)
leresti_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.leresti)
leresti_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.leresti)
leresti_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.leresti)
leresti_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.leresti)
leresti_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.leresti)
leresti_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.leresti)
leresti_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.leresti)

covariates_leresti <- cbind(leresti_distance_to_roads,leresti_distance_to_forest_edge,leresti_distance_to_riparian,leresti_distance_to_release_sites,leresti_NDVI_aug20,leresti_NDVI_mar21,leresti_NDWI_aug20,leresti_NDWI_mar21,leresti_elevation,leresti_TRI_50,leresti_broad_2000,leresti_mixed_2000,leresti_ngrass_2000,leresti_hm_grass_2000,leresti_transitional_2000,leresti_aspect_2000,leresti_slope_500)
```
add the covariate data to our SpatialPointsDataFrame of used and random steps
```{r bunea spatial df}
steps.sp.bunea$bunea_distance_to_roads <- covariates_bunea[,1]
steps.sp.bunea$bunea_distance_to_forest_edge <- covariates_bunea[,2]
steps.sp.bunea$bunea_distance_to_riparian <- covariates_bunea[,3]
steps.sp.bunea$bunea_distance_to_release_sites <- covariates_bunea[,4]
steps.sp.bunea$bunea_NDVI_aug20 <- covariates_bunea[,5]
steps.sp.bunea$bunea_NDVI_mar21 <- covariates_bunea[,6]
steps.sp.bunea$bunea_NDWI_aug20 <- covariates_bunea[,7]
steps.sp.bunea$bunea_NDWI_mar21 <- covariates_bunea[,8]
steps.sp.bunea$bunea_elevation <- covariates_bunea[,9]
steps.sp.bunea$bunea_TRI_50 <- covariates_bunea[,10]
steps.sp.bunea$bunea_broad_2000 <- covariates_bunea[,11]
steps.sp.bunea$bunea_mixed_2000 <- covariates_bunea[,12]
steps.sp.bunea$bunea_ngrass_2000 <- covariates_bunea[,13]
steps.sp.bunea$bunea_hm_grass_2000 <- covariates_bunea[,14]
steps.sp.bunea$bunea_transitional_2000 <- covariates_bunea[,15]
steps.sp.bunea$bunea_aspect_2000 <- covariates_bunea[,16]
steps.sp.bunea$bunea_slope_500 <- covariates_bunea[,17]

head(steps.sp.bunea)
```
leresti
```{r leresti spatial df}
steps.sp.leresti$leresti_distance_to_roads <- covariates_leresti[,1]
steps.sp.leresti$leresti_distance_to_forest_edge <- covariates_leresti[,2]
steps.sp.leresti$leresti_distance_to_riparian <- covariates_leresti[,3]
steps.sp.leresti$leresti_distance_to_release_sites <- covariates_leresti[,4]
steps.sp.leresti$leresti_NDVI_aug20 <- covariates_leresti[,5]
steps.sp.leresti$leresti_NDVI_mar21 <- covariates_leresti[,6]
steps.sp.leresti$leresti_NDWI_aug20 <- covariates_leresti[,7]
steps.sp.leresti$leresti_NDWI_mar21 <- covariates_leresti[,8]
steps.sp.leresti$leresti_elevation <- covariates_leresti[,9]
steps.sp.leresti$leresti_TRI_50 <- covariates_leresti[,10]
steps.sp.leresti$leresti_broad_2000 <- covariates_leresti[,11]
steps.sp.leresti$leresti_mixed_2000 <- covariates_leresti[,12]
steps.sp.leresti$leresti_ngrass_2000 <- covariates_leresti[,13]
steps.sp.leresti$leresti_hm_grass_2000 <- covariates_leresti[,14]
steps.sp.leresti$leresti_transitional_2000 <- covariates_leresti[,15]
steps.sp.leresti$leresti_aspect_2000 <- covariates_leresti[,16]
steps.sp.leresti$leresti_slope_500 <- covariates_leresti[,17]

head(steps.sp.leresti)
```
```{r}
#Export
write.csv(steps.sp.bunea, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.bunea.csv", row.names = FALSE)
write.csv(steps.sp.leresti, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.leresti.csv", row.names = FALSE)
```
Models
bunea
```{r bunea models}
#distance to riparian and distance to forest
buneamod1 <- survival::clogit(case_ ~ bunea_distance_to_riparian + bunea_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
coef(buneamod1)
#Distance to roads + distance to forests
buneamod2 <- survival::clogit(case_ ~bunea_distance_to_roads + bunea_distance_to_forest_edge + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#Distance to rip + distance to forests + distance to roads
buneamod3 <- survival::clogit(case_ ~bunea_distance_to_riparian + bunea_distance_to_roads + bunea_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
##Distance to rip and distance to forests interaction with  distance to roads
buneamod3.i <- survival::clogit(case_ ~bunea_distance_to_riparian*bunea_distance_to_forest_edge + bunea_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#Distance to rip + distance to forests + distance to release sites 
buneamod4 <- survival::clogit(case_ ~ bunea_distance_to_riparian + bunea_distance_to_release_sites + bunea_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI + NDWI bunea
buneamod5 <- survival::clogit(case_ ~bunea_NDVI_aug20 + bunea_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI + NDWI march
buneamod6 <- survival::clogit(case_ ~ bunea_NDVI_mar21 + bunea_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI + elevation bunea
buneamod7 <- survival::clogit(case_ ~ bunea_NDVI_aug20 + bunea_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI elevation interaction
buneamod7.i <- survival::clogit(case_ ~ bunea_NDVI_aug20*bunea_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI and elevation bunea
buneamod8 <- survival::clogit(case_ ~ bunea_NDVI_mar21 + bunea_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI and elevation interaction bunea
buneamod8.i <- survival::clogit(case_ ~ bunea_NDVI_mar21*bunea_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI + broad + mixed bunea
buneamod9 <- survival::clogit(case_ ~ bunea_NDVI_aug20 + bunea_broad_2000 + bunea_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI and broad interaction with mixed bunea
buneamod9.i<- survival::clogit(case_ ~ bunea_NDVI_aug20*bunea_broad_2000 + bunea_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI and mixed interaction with broad bunea
buneamod9.ii<- survival::clogit(case_ ~ bunea_NDVI_aug20*bunea_mixed_2000 + bunea_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI + broad + mixed bunea
buneamod10 <- survival::clogit(case_ ~ bunea_NDVI_mar21 + bunea_broad_2000 + bunea_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI and broad interaction with mixed bunea
buneamod10.i<- survival::clogit(case_ ~ bunea_NDVI_mar21*bunea_broad_2000 + bunea_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#NDVI and mixed interaction with broad bunea
buneamod10.ii<- survival::clogit(case_ ~ bunea_NDVI_mar21*bunea_mixed_2000 + bunea_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#broad and mixed
buneamod11 <- survival::clogit(case_ ~ bunea_broad_2000 + bunea_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#Natural grassland +hm grassland
buneamod12 <- survival::clogit(case_ ~ bunea_ngrass_2000 + bunea_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#natural grassland and human managed grassland interaction
buneamod12.i <- survival::clogit(case_ ~ bunea_ngrass_2000*bunea_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#Mixed forest+ transition habitat
buneamod13 <- survival::clogit(case_ ~ bunea_mixed_2000 + bunea_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#Broad + mixed + natgrass + hmgrass + transitional
buneamod14 <- survival::clogit(case_ ~ bunea_broad_2000 + bunea_mixed_2000 + bunea_ngrass_2000 + bunea_hm_grass_2000 + bunea_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#broad and mixed interaction with natural grasslands and human managed grassland
buneamod14.i <- survival::clogit(case_ ~ bunea_broad_2000*bunea_mixed_2000 + bunea_ngrass_2000 + bunea_hm_grass_2000 + bunea_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#natural grasslands and human managed grasslands interaction with broad and mixed
buneamod14.ii <- survival::clogit(case_ ~ bunea_broad_2000 + bunea_mixed_2000 + bunea_ngrass_2000*bunea_hm_grass_2000 + bunea_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
buneamod15 <- survival::clogit(case_ ~ bunea_broad_2000 + bunea_mixed_2000 + bunea_ngrass_2000 + bunea_hm_grass_2000 + bunea_transitional_2000 + bunea_distance_to_riparian + bunea_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#Broad + mixed + distance to roads
buneamod16 <- survival::clogit(case_ ~ bunea_broad_2000 + bunea_mixed_2000 + bunea_distance_to_roads + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#TRI + slope + elevation + aspect
buneamod17 <- survival::clogit(case_ ~ bunea_TRI_50 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#TRI and elevation interaction with slope + aspect
buneamod17.i <- survival::clogit(case_ ~ bunea_TRI_50*bunea_elevation + bunea_slope_500 + bunea_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#TRI + slope + elevation + aspect + ndvi + ndwi
buneamod18 <- survival::clogit(case_ ~ bunea_TRI_50 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_aug20 + bunea_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#TRI + slope + elevation + aspect + NDVI bunea + NDWI bunea
buneamod19 <- survival::clogit(case_ ~ bunea_TRI_50 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#TRI + slope + elevation + aspect +forest mixed + forest broad
buneamod20 <- survival::clogit(case_ ~ bunea_TRI_50 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_mixed_2000 + bunea_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#forest edge and roads
buneamod21 <- survival::clogit(case_ ~  bunea_distance_to_forest_edge*bunea_distance_to_roads + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
summary(buneamod21)
#forest edge and broad
buneamod22 <- survival::clogit(case_ ~ bunea_distance_to_forest_edge + bunea_broad_2000 + bunea_distance_to_forest_edge*bunea_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#riparian zones and elevation
buneamod23 <- survival::clogit(case_ ~ bunea_distance_to_riparian + bunea_elevation + bunea_distance_to_riparian* bunea_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#broadleaf forest and elevation (with TRI and NDVI)
buneamod24 <- survival::clogit(case_ ~ bunea_broad_2000*bunea_elevation + bunea_TRI_50 + bunea_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
buneamod24.1 <- survival::clogit(case_ ~ bunea_broad_2000*bunea_elevation + bunea_TRI_50 + bunea_NDVI_aug20 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#natural grasslands and distance to forest edge (with NDVI and elevation)
buneamod25 <- survival::clogit(case_ ~ bunea_ngrass_2000*bunea_distance_to_forest_edge + bunea_NDVI_mar21 + bunea_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#transitional and distance to forest edge (with elevation and aspect and TRI)
buneamod26 <- survival::clogit(case_ ~ bunea_transitional_2000*bunea_distance_to_forest_edge + bunea_elevation + bunea_aspect_2000 + bunea_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#transitional and mixed forest (with broadleaf and elevation)
buneamod27 <- survival::clogit(case_ ~ bunea_transitional_2000*bunea_mixed_2000 + bunea_elevation + bunea_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#transitional and broadleaf (with mixed and elevation)
buneamod28 <- survival::clogit(case_ ~ bunea_transitional_2000*bunea_broad_2000 + bunea_elevation + bunea_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to roads and broadleaf (with NDVI and elevation)
buneamod29 <- survival::clogit(case_ ~ bunea_distance_to_roads*bunea_broad_2000 + bunea_elevation + bunea_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to roads and mixed (with NDVI and elevation)
buneamod30 <- survival::clogit(case_ ~ bunea_distance_to_roads*bunea_mixed_2000 + bunea_elevation + bunea_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
buneamod31 <- survival::clogit(case_ ~ bunea_distance_to_roads*bunea_ngrass_2000 + bunea_elevation + bunea_NDVI_mar21 + bunea_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
buneamod32 <- survival::clogit(case_ ~ bunea_distance_to_roads*bunea_transitional_2000 + bunea_elevation + bunea_NDVI_mar21 + bunea_TRI_50 + bunea_ngrass_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
buneamod33 <- survival::clogit(case_ ~ bunea_distance_to_release_sites*bunea_ngrass_2000 + bunea_broad_2000 + bunea_NDVI_mar21 + bunea_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
buneamod34 <- survival::clogit(case_ ~ bunea_distance_to_release_sites*bunea_broad_2000 + bunea_ngrass_2000 + bunea_NDVI_mar21 + bunea_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to release sites and mixed (with grasslands, broad and NDVI)
buneamod35 <- survival::clogit(case_ ~ bunea_distance_to_release_sites*bunea_mixed_2000 + bunea_ngrass_2000 + bunea_NDVI_mar21 + bunea_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and broadleaf (with buneamod19-slope, elevation, aspect, NDVI and NDWI)
buneamod36 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_broad_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and natgrasslands (with buneamod19-slope, elevation, aspect, NDVI and NDWI)
buneamod37 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_ngrass_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and mixed (with buneamod19-slope, elevation, aspect, NDVI and NDWI)
buneamod38 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_mixed_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and transitional habitat (with buneamod19-slope, elevation, aspect, NDVI and NDWI)
buneamod39 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_transitional_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to forest edge and NDVI (with elevation, slope and TRI)
buneamod40 <- survival::clogit(case_ ~ bunea_distance_to_forest_edge*bunea_NDVI_mar21 + bunea_slope_500 + bunea_elevation + bunea_TRI_50 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to release sites and TRI (with aspect, elevation and slope)
buneamod41 <- survival::clogit(case_ ~ bunea_distance_to_release_sites*bunea_TRI_50 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to release sites and elevation (with aspect, TRI and slope)
buneamod42 <- survival::clogit(case_ ~ bunea_distance_to_release_sites*bunea_elevation + bunea_slope_500 + bunea_TRI_50 + bunea_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
buneamod43 <- survival::clogit(case_ ~ bunea_distance_to_forest_edge*bunea_broad_2000 + bunea_mixed_2000 + bunea_NDVI_mar21 + bunea_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
buneamod44 <- survival::clogit(case_ ~ bunea_distance_to_forest_edge*bunea_mixed_2000 + bunea_broad_2000 + bunea_NDVI_mar21 + bunea_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
#Elevation and TRI (with ndvi, slope and aspect)
buneamod45 <- survival::clogit(case_ ~ bunea_elevation*bunea_TRI_50+ bunea_broad_2000 + bunea_NDVI_mar21 + bunea_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
buneamod46 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_broad_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + bunea_distance_to_forest_edge + bunea_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
buneamod47 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_ngrass_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + bunea_distance_to_forest_edge + bunea_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
buneamod48 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_mixed_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + bunea_distance_to_forest_edge + bunea_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
buneamod49 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_transitional_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21+ bunea_distance_to_forest_edge + bunea_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneamod50 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_broad_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + bunea_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneamod51 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_ngrass_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + bunea_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneamod52 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_mixed_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21 + bunea_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneamod53 <- survival::clogit(case_ ~ bunea_TRI_50*bunea_transitional_2000 + bunea_slope_500 + bunea_elevation + bunea_aspect_2000 + bunea_NDVI_mar21 + bunea_NDWI_mar21+ bunea_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.bunea)
summary(buneamod1)
summary(buneamod2)
summary(buneamod3)
summary(buneamod3.i)
summary(buneamod4)
summary(buneamod5)
summary(buneamod6)
summary(buneamod7)
summary(buneamod8)
summary(buneamod8.i)
summary(buneamod9)
summary(buneamod9.i)
summary(buneamod9.ii)
summary(buneamod10)
summary(buneamod10.i)
summary(buneamod10.ii)
summary(buneamod11)
summary(buneamod12)
summary(buneamod12.i)
summary(buneamod13)
summary(buneamod14)
summary(buneamod14.i)
summary(buneamod14.ii)
summary(buneamod15)
summary(buneamod16)
summary(buneamod17)
summary(buneamod17.i)
summary(buneamod18)
summary(buneamod19)
summary(buneamod20)
summary(buneamod21)
summary(buneamod22)
summary(buneamod23)
summary(buneamod24)
summary(buneamod25)
summary(buneamod26)
summary(buneamod27)
summary(buneamod28)
summary(buneamod29)
summary(buneamod30)
summary(buneamod31)
summary(buneamod32)
summary(buneamod33)
summary(buneamod34)
summary(buneamod35)
summary(buneamod36)
summary(buneamod37)
summary(buneamod38)
summary(buneamod39)
summary(buneamod40)
summary(buneamod41)
summary(buneamod42)
summary(buneamod43)
summary(buneamod44)
summary(buneamod45)
summary(buneamod46)
summary(buneamod47)
summary(buneamod48)
summary(buneamod49)
summary(buneamod50)
summary(buneamod51)
summary(buneamod52)
summary(buneamod53)
```

AIC
```{r bunea AIC}
buneamodsel <- model.sel(buneamod1,buneamod2,buneamod3,buneamod3.i,buneamod4,buneamod5,buneamod6,buneamod7,buneamod8,buneamod8.i,buneamod9,buneamod9.i,buneamod9.ii,buneamod10,buneamod10.i,buneamod10.ii,buneamod11,buneamod12,buneamod12.i,buneamod13,buneamod14,buneamod14.i,buneamod14.ii,buneamod15,buneamod16,buneamod17,buneamod17.i,buneamod18,buneamod19,buneamod20,buneamod21, buneamod22, buneamod23, buneamod24, buneamod25, buneamod26, buneamod27, buneamod28,buneamod29,buneamod30,buneamod31,buneamod32,buneamod33,buneamod34,buneamod35,buneamod36,buneamod37,buneamod38,buneamod39,buneamod40,buneamod41,buneamod42,buneamod43,buneamod44,buneamod45,buneamod46,buneamod47,buneamod48,buneamod49,buneamod50,buneamod51,buneamod52,buneamod53)
buneamodsel #buneamod50 and 46
```
Models
leresti
```{r leresti models}
#distance to riparian and distance to forest
lerestimod1 <- survival::clogit(case_ ~ leresti_distance_to_riparian + leresti_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
coef(lerestimod1)
#Distance to roads + distance to forests
lerestimod2 <- survival::clogit(case_ ~leresti_distance_to_roads + leresti_distance_to_forest_edge + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#Distance to rip + distance to forests + distance to roads
lerestimod3 <- survival::clogit(case_ ~leresti_distance_to_riparian + leresti_distance_to_roads + leresti_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
##Distance to rip and distance to forests interaction with  distance to roads
lerestimod3.i <- survival::clogit(case_ ~leresti_distance_to_riparian*leresti_distance_to_forest_edge + leresti_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#Distance to rip + distance to forests + distance to release sites 
lerestimod4 <- survival::clogit(case_ ~ leresti_distance_to_riparian + leresti_distance_to_release_sites + leresti_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI + NDWI leresti
lerestimod5 <- survival::clogit(case_ ~leresti_NDVI_aug20 + leresti_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI + NDWI march
lerestimod6 <- survival::clogit(case_ ~ leresti_NDVI_mar21 + leresti_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI + elevation leresti
lerestimod7 <- survival::clogit(case_ ~ leresti_NDVI_aug20 + leresti_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI elevation interaction
lerestimod7.i <- survival::clogit(case_ ~ leresti_NDVI_aug20*leresti_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI and elevation leresti
lerestimod8 <- survival::clogit(case_ ~ leresti_NDVI_mar21 + leresti_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI and elevation interaction leresti
lerestimod8.i <- survival::clogit(case_ ~ leresti_NDVI_mar21*leresti_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI + broad + mixed leresti
lerestimod9 <- survival::clogit(case_ ~ leresti_NDVI_aug20 + leresti_broad_2000 + leresti_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI and broad interaction with mixed leresti
lerestimod9.i<- survival::clogit(case_ ~ leresti_NDVI_aug20*leresti_broad_2000 + leresti_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI and mixed interaction with broad leresti
lerestimod9.ii<- survival::clogit(case_ ~ leresti_NDVI_aug20*leresti_mixed_2000 + leresti_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI + broad + mixed leresti
lerestimod10 <- survival::clogit(case_ ~ leresti_NDVI_mar21 + leresti_broad_2000 + leresti_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI and broad interaction with mixed leresti
lerestimod10.i<- survival::clogit(case_ ~ leresti_NDVI_mar21*leresti_broad_2000 + leresti_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#NDVI and mixed interaction with broad leresti
lerestimod10.ii<- survival::clogit(case_ ~ leresti_NDVI_mar21*leresti_mixed_2000 + leresti_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#broad and mixed
lerestimod11 <- survival::clogit(case_ ~ leresti_broad_2000 + leresti_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#Natural grassland +hm grassland
lerestimod12 <- survival::clogit(case_ ~ leresti_ngrass_2000 + leresti_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#natural grassland and human managed grassland interaction
lerestimod12.i <- survival::clogit(case_ ~ leresti_ngrass_2000*leresti_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#Mixed forest+ transition habitat
lerestimod13 <- survival::clogit(case_ ~ leresti_mixed_2000 + leresti_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#Broad + mixed + natgrass + hmgrass + transitional
lerestimod14 <- survival::clogit(case_ ~ leresti_broad_2000 + leresti_mixed_2000 + leresti_ngrass_2000 + leresti_hm_grass_2000 + leresti_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#broad and mixed interaction with natural grasslands and human managed grassland
lerestimod14.i <- survival::clogit(case_ ~ leresti_broad_2000*leresti_mixed_2000 + leresti_ngrass_2000 + leresti_hm_grass_2000 + leresti_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#natural grasslands and human managed grasslands interaction with broad and mixed
lerestimod14.ii <- survival::clogit(case_ ~ leresti_broad_2000 + leresti_mixed_2000 + leresti_ngrass_2000*leresti_hm_grass_2000 + leresti_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
lerestimod15 <- survival::clogit(case_ ~ leresti_broad_2000 + leresti_mixed_2000 + leresti_ngrass_2000 + leresti_hm_grass_2000 + leresti_transitional_2000 + leresti_distance_to_riparian + leresti_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#Broad + mixed + distance to roads
lerestimod16 <- survival::clogit(case_ ~ leresti_broad_2000 + leresti_mixed_2000 + leresti_distance_to_roads + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#TRI + slope + elevation + aspect
lerestimod17 <- survival::clogit(case_ ~ leresti_TRI_50 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#TRI and elevation interaction with slope + aspect
lerestimod17.i <- survival::clogit(case_ ~ leresti_TRI_50*leresti_elevation + leresti_slope_500 + leresti_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#TRI + slope + elevation + aspect + ndvi + ndwi
lerestimod18 <- survival::clogit(case_ ~ leresti_TRI_50 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_aug20 + leresti_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#TRI + slope + elevation + aspect + NDVI leresti + NDWI leresti
lerestimod19 <- survival::clogit(case_ ~ leresti_TRI_50 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#TRI + slope + elevation + aspect +forest mixed + forest broad
lerestimod20 <- survival::clogit(case_ ~ leresti_TRI_50 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_mixed_2000 + leresti_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#forest edge and roads
lerestimod21 <- survival::clogit(case_ ~  leresti_distance_to_forest_edge*leresti_distance_to_roads + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
summary(lerestimod21)
#forest edge and broad
lerestimod22 <- survival::clogit(case_ ~ leresti_distance_to_forest_edge + leresti_broad_2000 + leresti_distance_to_forest_edge*leresti_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#riparian zones and elevation
lerestimod23 <- survival::clogit(case_ ~ leresti_distance_to_riparian + leresti_elevation + leresti_distance_to_riparian* leresti_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#broadleaf forest and elevation (with TRI and NDVI)
lerestimod24 <- survival::clogit(case_ ~ leresti_broad_2000*leresti_elevation + leresti_TRI_50 + leresti_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
lerestimod24.1 <- survival::clogit(case_ ~ leresti_broad_2000*leresti_elevation + leresti_TRI_50 + leresti_NDVI_aug20 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#natural grasslands and distance to forest edge (with NDVI and elevation)
lerestimod25 <- survival::clogit(case_ ~ leresti_ngrass_2000*leresti_distance_to_forest_edge + leresti_NDVI_mar21 + leresti_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#transitional and distance to forest edge (with elevation and aspect and TRI)
lerestimod26 <- survival::clogit(case_ ~ leresti_transitional_2000*leresti_distance_to_forest_edge + leresti_elevation + leresti_aspect_2000 + leresti_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#transitional and mixed forest (with broadleaf and elevation)
lerestimod27 <- survival::clogit(case_ ~ leresti_transitional_2000*leresti_mixed_2000 + leresti_elevation + leresti_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#transitional and broadleaf (with mixed and elevation)
lerestimod28 <- survival::clogit(case_ ~ leresti_transitional_2000*leresti_broad_2000 + leresti_elevation + leresti_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to roads and broadleaf (with NDVI and elevation)
lerestimod29 <- survival::clogit(case_ ~ leresti_distance_to_roads*leresti_broad_2000 + leresti_elevation + leresti_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to roads and mixed (with NDVI and elevation)
lerestimod30 <- survival::clogit(case_ ~ leresti_distance_to_roads*leresti_mixed_2000 + leresti_elevation + leresti_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
lerestimod31 <- survival::clogit(case_ ~ leresti_distance_to_roads*leresti_ngrass_2000 + leresti_elevation + leresti_NDVI_mar21 + leresti_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
lerestimod32 <- survival::clogit(case_ ~ leresti_distance_to_roads*leresti_transitional_2000 + leresti_elevation + leresti_NDVI_mar21 + leresti_TRI_50 + leresti_ngrass_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
lerestimod33 <- survival::clogit(case_ ~ leresti_distance_to_release_sites*leresti_ngrass_2000 + leresti_broad_2000 + leresti_NDVI_mar21 + leresti_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
lerestimod34 <- survival::clogit(case_ ~ leresti_distance_to_release_sites*leresti_broad_2000 + leresti_ngrass_2000 + leresti_NDVI_mar21 + leresti_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to release sites and mixed (with grasslands, broad and NDVI)
lerestimod35 <- survival::clogit(case_ ~ leresti_distance_to_release_sites*leresti_mixed_2000 + leresti_ngrass_2000 + leresti_NDVI_mar21 + leresti_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and broadleaf (with lerestimod19-slope, elevation, aspect, NDVI and NDWI)
lerestimod36 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_broad_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and natgrasslands (with lerestimod19-slope, elevation, aspect, NDVI and NDWI)
lerestimod37 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_ngrass_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and mixed (with lerestimod19-slope, elevation, aspect, NDVI and NDWI)
lerestimod38 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_mixed_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and transitional habitat (with lerestimod19-slope, elevation, aspect, NDVI and NDWI)
lerestimod39 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_transitional_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to forest edge and NDVI (with elevation, slope and TRI)
lerestimod40 <- survival::clogit(case_ ~ leresti_distance_to_forest_edge*leresti_NDVI_mar21 + leresti_slope_500 + leresti_elevation + leresti_TRI_50 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to release sites and TRI (with aspect, elevation and slope)
lerestimod41 <- survival::clogit(case_ ~ leresti_distance_to_release_sites*leresti_TRI_50 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to release sites and elevation (with aspect, TRI and slope)
lerestimod42 <- survival::clogit(case_ ~ leresti_distance_to_release_sites*leresti_elevation + leresti_slope_500 + leresti_TRI_50 + leresti_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
lerestimod43 <- survival::clogit(case_ ~ leresti_distance_to_forest_edge*leresti_broad_2000 + leresti_mixed_2000 + leresti_NDVI_mar21 + leresti_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
lerestimod44 <- survival::clogit(case_ ~ leresti_distance_to_forest_edge*leresti_mixed_2000 + leresti_broad_2000 + leresti_NDVI_mar21 + leresti_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
#Elevation and TRI (with ndvi, slope and aspect)
lerestimod45 <- survival::clogit(case_ ~ leresti_elevation*leresti_TRI_50+ leresti_broad_2000 + leresti_NDVI_mar21 + leresti_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
lerestimod46 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_broad_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + leresti_distance_to_forest_edge + leresti_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
lerestimod47 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_ngrass_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + leresti_distance_to_forest_edge + leresti_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
lerestimod48 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_mixed_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + leresti_distance_to_forest_edge + leresti_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
lerestimod49 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_transitional_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21+ leresti_distance_to_forest_edge + leresti_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestimod50 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_broad_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + leresti_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestimod51 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_ngrass_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + leresti_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestimod52 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_mixed_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21 + leresti_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestimod53 <- survival::clogit(case_ ~ leresti_TRI_50*leresti_transitional_2000 + leresti_slope_500 + leresti_elevation + leresti_aspect_2000 + leresti_NDVI_mar21 + leresti_NDWI_mar21+ leresti_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.leresti)
summary(lerestimod1)
summary(lerestimod2)
summary(lerestimod3)
summary(lerestimod3.i)
summary(lerestimod4)
summary(lerestimod5)
summary(lerestimod6)
summary(lerestimod7)
summary(lerestimod8)
summary(lerestimod8.i)
summary(lerestimod9)
summary(lerestimod9.i)
summary(lerestimod9.ii)
summary(lerestimod10)
summary(lerestimod10.i)
summary(lerestimod10.ii)
summary(lerestimod11)
summary(lerestimod12)
summary(lerestimod12.i)
summary(lerestimod13)
summary(lerestimod14)
summary(lerestimod14.i)
summary(lerestimod14.ii)
summary(lerestimod15)
summary(lerestimod16)
summary(lerestimod17)
summary(lerestimod17.i)
summary(lerestimod18)
summary(lerestimod19)
summary(lerestimod20)
summary(lerestimod21)
summary(lerestimod22)
summary(lerestimod23)
summary(lerestimod24)
summary(lerestimod25)
summary(lerestimod26)
summary(lerestimod27)
summary(lerestimod28)
summary(lerestimod29)
summary(lerestimod30)
summary(lerestimod31)
summary(lerestimod32)
summary(lerestimod33)
summary(lerestimod34)
summary(lerestimod35)
summary(lerestimod36)
summary(lerestimod37)
summary(lerestimod38)
summary(lerestimod39)
summary(lerestimod40)
summary(lerestimod41)
summary(lerestimod42)
summary(lerestimod43)
summary(lerestimod44)
summary(lerestimod45)
summary(lerestimod46)
summary(lerestimod47)
summary(lerestimod48)
summary(lerestimod49)
summary(lerestimod50)
summary(lerestimod51)
summary(lerestimod52)
summary(lerestimod53)
```

AIC
```{r leresti AIC}
library(MuMIn)
lerestimodsel <- model.sel(lerestimod1,lerestimod2,lerestimod3,lerestimod3.i,lerestimod4,lerestimod5,lerestimod6,lerestimod7,lerestimod8,lerestimod8.i,lerestimod9,lerestimod9.i,lerestimod9.ii,lerestimod10,lerestimod10.i,lerestimod10.ii,lerestimod11,lerestimod12,lerestimod12.i,lerestimod13,lerestimod14,lerestimod14.i,lerestimod14.ii,lerestimod15,lerestimod16,lerestimod17,lerestimod17.i,lerestimod18,lerestimod19,lerestimod20,lerestimod21, lerestimod22, lerestimod23, lerestimod24, lerestimod25, lerestimod26, lerestimod27, lerestimod28,lerestimod29,lerestimod30,lerestimod31,lerestimod32,lerestimod33,lerestimod34,lerestimod35,lerestimod36,lerestimod37,lerestimod38,lerestimod39,lerestimod40,lerestimod41,lerestimod42,lerestimod43,lerestimod44,lerestimod45,lerestimod46,lerestimod47,lerestimod48,lerestimod49,lerestimod50,lerestimod51,lerestimod52,lerestimod53)
lerestimodsel #lerestimod50 and 46
#testing AIC between top bunea and leresti model vs top all data model
herdmodsel <- model.sel(lerestimod50,lerestimod52)
herdmodsel
herdmodsel2 <- model.sel(buneamod50,buneamod52)
herdmodsel2
```

Bunea I and II
tracks
```{r Bunea I and II tracks}
#subset buneaI
buneaI_tracks <- BuneaI %>%
  dplyr::select(x = longitude, y = latitude,
                t = t, id = Collar.ID)
#subset buneaII
buneaII_tracks <- BuneaII %>%
  dplyr::select(x = longitude, y = latitude,
                t = t, id = Collar.ID)
#remove NAs
buneaII_tracks <-na.omit(buneaII_tracks)
buneaI_tracks <-na.omit(buneaI_tracks)
#nest by id
nested_buneaI <- 
  buneaI_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_buneaI)
#nest by id
nested_buneaII <- 
  buneaII_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_buneaII)
```
Step lengths
```{r bunea I and II step lengths}
step.lengths.buneaI <- unlist(map(nested_buneaI$track, step_lengths))
hist(step.lengths.buneaI, breaks = 20, main="Histogram of step lengths buneaI", xlab="Step lengths")
step.lengths.buneaII <- unlist(map(nested_buneaII$track, step_lengths))
hist(step.lengths.buneaII, breaks = 20, main="Histogram of step lengths buneaII", xlab="Step lengths")
```

```{r bunea I and II true steps}
true.steps.buneaI <- map(nested_buneaI$track, steps)
head(true.steps.buneaI[[1]])
true.steps.buneaII <- map(nested_buneaI$track, steps)
head(true.steps.buneaII[[1]])
```
Create random steps
Generating 5 random steps per used step.
.id="id" creates a new column with the id of the list so we can still separate data by animal.
```{r bunea I and II ranomd steps}
true.random.steps.buneaI <- map(true.steps.buneaI, random_steps, n=5)
all.steps.buneaI <- bind_rows(true.random.steps.buneaI, .id="id")
all.steps.buneaI
true.random.steps.buneaII <- map(true.steps.buneaII, random_steps, n=5)
all.steps.buneaII <- bind_rows(true.random.steps.buneaII, .id="id")
all.steps.buneaII
```
distribution of turning angles for used steps only
```{r bunea I and II turning angles}
with(all.steps.buneaI, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles buneaI", xlab="turning angle"))
with(all.steps.buneaII, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles buneaII", xlab="turning angle"))
```

```{r bunea I and II clean up}
steps.sp.buneaI <- all.steps.buneaI
steps.sp.buneaII <- all.steps.buneaII
#remove NA
steps.sp.buneaI <- na.omit(steps.sp.buneaI)
steps.sp.buneaII <- na.omit(steps.sp.buneaII)
coordinates(steps.sp.buneaI) <- ~x2_+y2_
proj4string(steps.sp.buneaI) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
coordinates(steps.sp.buneaII) <- ~x2_+y2_
proj4string(steps.sp.buneaII) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
```
Extract habitat covariate data
buneaI
```{r bunea I covariate extraction}
buneaI_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.buneaI)
buneaI_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.buneaI)
buneaI_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.buneaI)
buneaI_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.buneaI)
buneaI_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.buneaI)
buneaI_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.buneaI)
buneaI_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.buneaI)
buneaI_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.buneaI)
buneaI_elevation <- raster::extract(elevation_scaled, steps.sp.buneaI)
buneaI_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.buneaI)
buneaI_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.buneaI)
buneaI_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.buneaI)
buneaI_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.buneaI)
buneaI_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.buneaI)
buneaI_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.buneaI)
buneaI_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.buneaI)
buneaI_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.buneaI)

covariates_buneaI <- cbind(buneaI_distance_to_roads,buneaI_distance_to_forest_edge,buneaI_distance_to_riparian,buneaI_distance_to_release_sites,buneaI_NDVI_aug20,buneaI_NDVI_mar21,buneaI_NDWI_aug20,buneaI_NDWI_mar21,buneaI_elevation,buneaI_TRI_50,buneaI_broad_2000,buneaI_mixed_2000,buneaI_ngrass_2000,buneaI_hm_grass_2000,buneaI_transitional_2000,buneaI_aspect_2000,buneaI_slope_500)
```
buneaII
```{r bunea II covariate extraction}
buneaII_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.buneaII)
buneaII_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.buneaII)
buneaII_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.buneaII)
buneaII_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.buneaII)
buneaII_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.buneaII)
buneaII_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.buneaII)
buneaII_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.buneaII)
buneaII_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.buneaII)
buneaII_elevation <- raster::extract(elevation_scaled, steps.sp.buneaII)
buneaII_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.buneaII)
buneaII_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.buneaII)
buneaII_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.buneaII)
buneaII_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.buneaII)
buneaII_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.buneaII)
buneaII_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.buneaII)
buneaII_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.buneaII)
buneaII_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.buneaII)

covariates_buneaII <- cbind(buneaII_distance_to_roads,buneaII_distance_to_forest_edge,buneaII_distance_to_riparian,buneaII_distance_to_release_sites,buneaII_NDVI_aug20,buneaII_NDVI_mar21,buneaII_NDWI_aug20,buneaII_NDWI_mar21,buneaII_elevation,buneaII_TRI_50,buneaII_broad_2000,buneaII_mixed_2000,buneaII_ngrass_2000,buneaII_hm_grass_2000,buneaII_transitional_2000,buneaII_aspect_2000,buneaII_slope_500)
```
add the covariate data to our SpatialPointsDataFrame of used and random steps
```{r bunea I spatial df}
steps.sp.buneaI$buneaI_distance_to_roads <- covariates_buneaI[,1]
steps.sp.buneaI$buneaI_distance_to_forest_edge <- covariates_buneaI[,2]
steps.sp.buneaI$buneaI_distance_to_riparian <- covariates_buneaI[,3]
steps.sp.buneaI$buneaI_distance_to_release_sites <- covariates_buneaI[,4]
steps.sp.buneaI$buneaI_NDVI_aug20 <- covariates_buneaI[,5]
steps.sp.buneaI$buneaI_NDVI_mar21 <- covariates_buneaI[,6]
steps.sp.buneaI$buneaI_NDWI_aug20 <- covariates_buneaI[,7]
steps.sp.buneaI$buneaI_NDWI_mar21 <- covariates_buneaI[,8]
steps.sp.buneaI$buneaI_elevation <- covariates_buneaI[,9]
steps.sp.buneaI$buneaI_TRI_50 <- covariates_buneaI[,10]
steps.sp.buneaI$buneaI_broad_2000 <- covariates_buneaI[,11]
steps.sp.buneaI$buneaI_mixed_2000 <- covariates_buneaI[,12]
steps.sp.buneaI$buneaI_ngrass_2000 <- covariates_buneaI[,13]
steps.sp.buneaI$buneaI_hm_grass_2000 <- covariates_buneaI[,14]
steps.sp.buneaI$buneaI_transitional_2000 <- covariates_buneaI[,15]
steps.sp.buneaI$buneaI_aspect_2000 <- covariates_buneaI[,16]
steps.sp.buneaI$buneaI_slope_500 <- covariates_buneaI[,17]

head(steps.sp.buneaI)
```
buneaII
```{r bunea spatial df}
steps.sp.buneaII$buneaII_distance_to_roads <- covariates_buneaII[,1]
steps.sp.buneaII$buneaII_distance_to_forest_edge <- covariates_buneaII[,2]
steps.sp.buneaII$buneaII_distance_to_riparian <- covariates_buneaII[,3]
steps.sp.buneaII$buneaII_distance_to_release_sites <- covariates_buneaII[,4]
steps.sp.buneaII$buneaII_NDVI_aug20 <- covariates_buneaII[,5]
steps.sp.buneaII$buneaII_NDVI_mar21 <- covariates_buneaII[,6]
steps.sp.buneaII$buneaII_NDWI_aug20 <- covariates_buneaII[,7]
steps.sp.buneaII$buneaII_NDWI_mar21 <- covariates_buneaII[,8]
steps.sp.buneaII$buneaII_elevation <- covariates_buneaII[,9]
steps.sp.buneaII$buneaII_TRI_50 <- covariates_buneaII[,10]
steps.sp.buneaII$buneaII_broad_2000 <- covariates_buneaII[,11]
steps.sp.buneaII$buneaII_mixed_2000 <- covariates_buneaII[,12]
steps.sp.buneaII$buneaII_ngrass_2000 <- covariates_buneaII[,13]
steps.sp.buneaII$buneaII_hm_grass_2000 <- covariates_buneaII[,14]
steps.sp.buneaII$buneaII_transitional_2000 <- covariates_buneaII[,15]
steps.sp.buneaII$buneaII_aspect_2000 <- covariates_buneaII[,16]
steps.sp.buneaII$buneaII_slope_500 <- covariates_buneaII[,17]

head(steps.sp.buneaII)
```
```{r}
#Export
write.csv(steps.sp.buneaI, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.buneaI.csv", row.names = FALSE)
write.csv(steps.sp.buneaII, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.buneaII.csv", row.names = FALSE)
```

Models
buneaI
```{r buneaI models}
#id removed (as only one individual)
#distance to riparian and distance to forest
buneaImod1 <- survival::clogit(case_ ~ buneaI_distance_to_riparian + buneaI_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
coef(buneaImod1)
#Distance to roads + distance to forests
buneaImod2 <- survival::clogit(case_ ~buneaI_distance_to_roads + buneaI_distance_to_forest_edge + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#Distance to rip + distance to forests + distance to roads
buneaImod3 <- survival::clogit(case_ ~buneaI_distance_to_riparian + buneaI_distance_to_roads + buneaI_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
##Distance to rip and distance to forests interaction with  distance to roads
buneaImod3.i <- survival::clogit(case_ ~buneaI_distance_to_riparian*buneaI_distance_to_forest_edge + buneaI_distance_to_forest_edge +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#Distance to rip + distance to forests + distance to release sites 
buneaImod4 <- survival::clogit(case_ ~ buneaI_distance_to_riparian + buneaI_distance_to_release_sites + buneaI_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI + NDWI buneaI
buneaImod5 <- survival::clogit(case_ ~buneaI_NDVI_aug20 + buneaI_NDWI_aug20 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI + NDWI march
buneaImod6 <- survival::clogit(case_ ~ buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI + elevation buneaI
buneaImod7 <- survival::clogit(case_ ~ buneaI_NDVI_aug20 + buneaI_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI elevation interaction
buneaImod7.i <- survival::clogit(case_ ~ buneaI_NDVI_aug20*buneaI_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI and elevation buneaI
buneaImod8 <- survival::clogit(case_ ~ buneaI_NDVI_mar21 + buneaI_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI and elevation interaction buneaI
buneaImod8.i <- survival::clogit(case_ ~ buneaI_NDVI_mar21*buneaI_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI + broad + mixed buneaI
buneaImod9 <- survival::clogit(case_ ~ buneaI_NDVI_aug20 + buneaI_broad_2000 + buneaI_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI and broad interaction with mixed buneaI
buneaImod9.i<- survival::clogit(case_ ~ buneaI_NDVI_aug20*buneaI_broad_2000 + buneaI_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI and mixed interaction with broad buneaI
buneaImod9.ii<- survival::clogit(case_ ~ buneaI_NDVI_aug20*buneaI_mixed_2000 + buneaI_broad_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI + broad + mixed buneaI
buneaImod10 <- survival::clogit(case_ ~ buneaI_NDVI_mar21 + buneaI_broad_2000 + buneaI_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI and broad interaction with mixed buneaI
buneaImod10.i<- survival::clogit(case_ ~ buneaI_NDVI_mar21*buneaI_broad_2000 + buneaI_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#NDVI and mixed interaction with broad buneaI
buneaImod10.ii<- survival::clogit(case_ ~ buneaI_NDVI_mar21*buneaI_mixed_2000 + buneaI_broad_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#broad and mixed
buneaImod11 <- survival::clogit(case_ ~ buneaI_broad_2000 + buneaI_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#Natural grassland +hm grassland
buneaImod12 <- survival::clogit(case_ ~ buneaI_ngrass_2000 + buneaI_hm_grass_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#natural grassland and human managed grassland interaction
buneaImod12.i <- survival::clogit(case_ ~ buneaI_ngrass_2000*buneaI_hm_grass_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#Mixed forest+ transition habitat
buneaImod13 <- survival::clogit(case_ ~ buneaI_mixed_2000 + buneaI_transitional_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#Broad + mixed + natgrass + hmgrass + transitional
buneaImod14 <- survival::clogit(case_ ~ buneaI_broad_2000 + buneaI_mixed_2000 + buneaI_ngrass_2000 + buneaI_hm_grass_2000 + buneaI_transitional_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#broad and mixed interaction with natural grasslands and human managed grassland
buneaImod14.i <- survival::clogit(case_ ~ buneaI_broad_2000*buneaI_mixed_2000 + buneaI_ngrass_2000 + buneaI_hm_grass_2000 + buneaI_transitional_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#natural grasslands and human managed grasslands interaction with broad and mixed
buneaImod14.ii <- survival::clogit(case_ ~ buneaI_broad_2000 + buneaI_mixed_2000 + buneaI_ngrass_2000*buneaI_hm_grass_2000 + buneaI_transitional_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
buneaImod15 <- survival::clogit(case_ ~ buneaI_broad_2000 + buneaI_mixed_2000 + buneaI_ngrass_2000 + buneaI_hm_grass_2000 + buneaI_transitional_2000 + buneaI_distance_to_riparian + buneaI_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#Broad + mixed + distance to roads
buneaImod16 <- survival::clogit(case_ ~ buneaI_broad_2000 + buneaI_mixed_2000 + buneaI_distance_to_roads + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#TRI + slope + elevation + aspect
buneaImod17 <- survival::clogit(case_ ~ buneaI_TRI_50 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#TRI and elevation interaction with slope + aspect
buneaImod17.i <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_elevation + buneaI_slope_500 + buneaI_aspect_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#TRI + slope + elevation + aspect + ndvi + ndwi
buneaImod18 <- survival::clogit(case_ ~ buneaI_TRI_50 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_aug20 + buneaI_NDWI_aug20 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#TRI + slope + elevation + aspect + NDVI buneaI + NDWI buneaI
buneaImod19 <- survival::clogit(case_ ~ buneaI_TRI_50 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#TRI + slope + elevation + aspect +forest mixed + forest broad
buneaImod20 <- survival::clogit(case_ ~ buneaI_TRI_50 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_mixed_2000 + buneaI_broad_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#forest edge and roads
buneaImod21 <- survival::clogit(case_ ~  buneaI_distance_to_forest_edge*buneaI_distance_to_roads + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
summary(buneaImod21)
#forest edge and broad
buneaImod22 <- survival::clogit(case_ ~ buneaI_distance_to_forest_edge + buneaI_broad_2000 + buneaI_distance_to_forest_edge*buneaI_broad_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#riparian zones and elevation
buneaImod23 <- survival::clogit(case_ ~ buneaI_distance_to_riparian + buneaI_elevation + buneaI_distance_to_riparian* buneaI_elevation + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#broadleaf forest and elevation (with TRI and NDVI)
buneaImod24 <- survival::clogit(case_ ~ buneaI_broad_2000*buneaI_elevation + buneaI_TRI_50 + buneaI_NDVI_mar21 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
buneaImod24.1 <- survival::clogit(case_ ~ buneaI_broad_2000*buneaI_elevation + buneaI_TRI_50 + buneaI_NDVI_aug20 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#natural grasslands and distance to forest edge (with NDVI and elevation)
buneaImod25 <- survival::clogit(case_ ~ buneaI_ngrass_2000*buneaI_distance_to_forest_edge + buneaI_NDVI_mar21 + buneaI_elevation  + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#transitional and distance to forest edge (with elevation and aspect and TRI)
buneaImod26 <- survival::clogit(case_ ~ buneaI_transitional_2000*buneaI_distance_to_forest_edge + buneaI_elevation + buneaI_aspect_2000 + buneaI_TRI_50 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#transitional and mixed forest (with broadleaf and elevation)
buneaImod27 <- survival::clogit(case_ ~ buneaI_transitional_2000*buneaI_mixed_2000 + buneaI_elevation + buneaI_broad_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#transitional and broadleaf (with mixed and elevation)
buneaImod28 <- survival::clogit(case_ ~ buneaI_transitional_2000*buneaI_broad_2000 + buneaI_elevation + buneaI_mixed_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to roads and broadleaf (with NDVI and elevation)
buneaImod29 <- survival::clogit(case_ ~ buneaI_distance_to_roads*buneaI_broad_2000 + buneaI_elevation + buneaI_NDVI_mar21 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to roads and mixed (with NDVI and elevation)
buneaImod30 <- survival::clogit(case_ ~ buneaI_distance_to_roads*buneaI_mixed_2000 + buneaI_elevation + buneaI_NDVI_mar21 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
buneaImod31 <- survival::clogit(case_ ~ buneaI_distance_to_roads*buneaI_ngrass_2000 + buneaI_elevation + buneaI_NDVI_mar21 + buneaI_TRI_50 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
buneaImod32 <- survival::clogit(case_ ~ buneaI_distance_to_roads*buneaI_transitional_2000 + buneaI_elevation + buneaI_NDVI_mar21 + buneaI_TRI_50 + buneaI_ngrass_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
buneaImod33 <- survival::clogit(case_ ~ buneaI_distance_to_release_sites*buneaI_ngrass_2000 + buneaI_broad_2000 + buneaI_NDVI_mar21 + buneaI_mixed_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
buneaImod34 <- survival::clogit(case_ ~ buneaI_distance_to_release_sites*buneaI_broad_2000 + buneaI_ngrass_2000 + buneaI_NDVI_mar21 + buneaI_mixed_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to release sites and mixed (with grasslands, broad and NDVI)
buneaImod35 <- survival::clogit(case_ ~ buneaI_distance_to_release_sites*buneaI_mixed_2000 + buneaI_ngrass_2000 + buneaI_NDVI_mar21 + buneaI_broad_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and broadleaf (with buneaImod19-slope, elevation, aspect, NDVI and NDWI)
buneaImod36 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_broad_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and natgrasslands (with buneaImod19-slope, elevation, aspect, NDVI and NDWI)
buneaImod37 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_ngrass_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and mixed (with buneaImod19-slope, elevation, aspect, NDVI and NDWI)
buneaImod38 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_mixed_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and transitional habitat (with buneaImod19-slope, elevation, aspect, NDVI and NDWI)
buneaImod39 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_transitional_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to forest edge and NDVI (with elevation, slope and TRI)
buneaImod40 <- survival::clogit(case_ ~ buneaI_distance_to_forest_edge*buneaI_NDVI_mar21 + buneaI_slope_500 + buneaI_elevation + buneaI_TRI_50 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to release sites and TRI (with aspect, elevation and slope)
buneaImod41 <- survival::clogit(case_ ~ buneaI_distance_to_release_sites*buneaI_TRI_50 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to release sites and elevation (with aspect, TRI and slope)
buneaImod42 <- survival::clogit(case_ ~ buneaI_distance_to_release_sites*buneaI_elevation + buneaI_slope_500 + buneaI_TRI_50 + buneaI_aspect_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
buneaImod43 <- survival::clogit(case_ ~ buneaI_distance_to_forest_edge*buneaI_broad_2000 + buneaI_mixed_2000 + buneaI_NDVI_mar21 + buneaI_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
buneaImod44 <- survival::clogit(case_ ~ buneaI_distance_to_forest_edge*buneaI_mixed_2000 + buneaI_broad_2000 + buneaI_NDVI_mar21 + buneaI_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#Elevation and TRI (with ndvi, slope and aspect)
buneaImod45 <- survival::clogit(case_ ~ buneaI_elevation*buneaI_TRI_50+ buneaI_broad_2000 + buneaI_NDVI_mar21 + buneaI_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
#TRI and broad interaction with elevation, aspect, winter NDVI, distance to forest and distance to release sites
buneaImod46 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_broad_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + buneaI_distance_to_forest_edge + buneaI_distance_to_release_sites + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
buneaImod47 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_ngrass_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + buneaI_distance_to_forest_edge + buneaI_distance_to_release_sites + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
buneaImod48 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_mixed_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + buneaI_distance_to_forest_edge + buneaI_distance_to_release_sites + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
buneaImod49 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_transitional_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21+ buneaI_distance_to_forest_edge + buneaI_distance_to_release_sites + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneaImod50 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_broad_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + buneaI_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneaImod51 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_ngrass_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + buneaI_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneaImod52 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_mixed_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21 + buneaI_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneaImod53 <- survival::clogit(case_ ~ buneaI_TRI_50*buneaI_transitional_2000 + buneaI_slope_500 + buneaI_elevation + buneaI_aspect_2000 + buneaI_NDVI_mar21 + buneaI_NDWI_mar21+ buneaI_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaI)
summary(buneaImod1)
summary(buneaImod2)
summary(buneaImod3)
summary(buneaImod3.i)
summary(buneaImod4)
summary(buneaImod5)
summary(buneaImod6)
summary(buneaImod7)
summary(buneaImod8)
summary(buneaImod8.i)
summary(buneaImod9)
summary(buneaImod9.i)
summary(buneaImod9.ii)
summary(buneaImod10)
summary(buneaImod10.i)
summary(buneaImod10.ii)
summary(buneaImod11)
summary(buneaImod12)
summary(buneaImod12.i)
summary(buneaImod13)
summary(buneaImod14)
summary(buneaImod14.i)
summary(buneaImod14.ii)
summary(buneaImod15)
summary(buneaImod16)
summary(buneaImod17)
summary(buneaImod17.i)
summary(buneaImod18)
summary(buneaImod19)
summary(buneaImod20)
summary(buneaImod21)
summary(buneaImod22)
summary(buneaImod23)
summary(buneaImod24)
summary(buneaImod25)
summary(buneaImod26)
summary(buneaImod27)
summary(buneaImod28)
summary(buneaImod29)
summary(buneaImod30)
summary(buneaImod31)
summary(buneaImod32)
summary(buneaImod33)
summary(buneaImod34)
summary(buneaImod35)
summary(buneaImod36)
summary(buneaImod37)
summary(buneaImod38)
summary(buneaImod39)
summary(buneaImod40)
summary(buneaImod41)
summary(buneaImod42)
summary(buneaImod43)
summary(buneaImod44)
summary(buneaImod45)
summary(buneaImod46)
summary(buneaImod47)
summary(buneaImod48)
summary(buneaImod49)
summary(buneaImod50)
summary(buneaImod51)
summary(buneaImod52)
summary(buneaImod53)
```

AIC
```{r buneaI AIC}
buneaImodsel <- model.sel(buneaImod1,buneaImod2,buneaImod3,buneaImod3.i,buneaImod4,buneaImod5,buneaImod6,buneaImod7,buneaImod8,buneaImod8.i,buneaImod9,buneaImod9.i,buneaImod9.ii,buneaImod10,buneaImod10.i,buneaImod10.ii,buneaImod11,buneaImod12,buneaImod12.i,buneaImod13,buneaImod14,buneaImod14.i,buneaImod14.ii,buneaImod15,buneaImod16,buneaImod17,buneaImod17.i,buneaImod18,buneaImod19,buneaImod20,buneaImod21, buneaImod22, buneaImod23, buneaImod24, buneaImod25, buneaImod26, buneaImod27, buneaImod28,buneaImod29,buneaImod30,buneaImod31,buneaImod32,buneaImod33,buneaImod34,buneaImod35,buneaImod36,buneaImod37,buneaImod38,buneaImod39,buneaImod40,buneaImod41,buneaImod42,buneaImod43,buneaImod44,buneaImod45,buneaImod46,buneaImod47,buneaImod48,buneaImod49,buneaImod50,buneaImod51,buneaImod52,buneaImod53)
buneaImodsel #buneaImod51 and 47
```

Models
buneaII
```{r buneaII models}
#distance to riparian and distance to forest
buneaIImod1 <- survival::clogit(case_ ~ buneaII_distance_to_riparian + buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
coef(buneaIImod1)
summary(buneaIImod1)
#Distance to roads + distance to forests
buneaIImod2 <- survival::clogit(case_ ~buneaII_distance_to_roads + buneaII_distance_to_forest_edge + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#Distance to rip + distance to forests + distance to roads
buneaIImod3 <- survival::clogit(case_ ~buneaII_distance_to_riparian + buneaII_distance_to_roads + buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
##Distance to rip and distance to forests interaction with  distance to roads
buneaIImod3.i <- survival::clogit(case_ ~buneaII_distance_to_riparian*buneaII_distance_to_forest_edge + buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#Distance to rip + distance to forests + distance to release sites 
buneaIImod4 <- survival::clogit(case_ ~ buneaII_distance_to_riparian + buneaII_distance_to_release_sites + buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI + NDWI buneaII
buneaIImod5 <- survival::clogit(case_ ~buneaII_NDVI_aug20 + buneaII_NDWI_aug20 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI + NDWI march
buneaIImod6 <- survival::clogit(case_ ~ buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI + elevation buneaII
buneaIImod7 <- survival::clogit(case_ ~ buneaII_NDVI_aug20 + buneaII_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI elevation interaction
buneaIImod7.i <- survival::clogit(case_ ~ buneaII_NDVI_aug20*buneaII_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI and elevation buneaII
buneaIImod8 <- survival::clogit(case_ ~ buneaII_NDVI_mar21 + buneaII_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI and elevation interaction buneaII
buneaIImod8.i <- survival::clogit(case_ ~ buneaII_NDVI_mar21*buneaII_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI + broad + mixed buneaII
buneaIImod9 <- survival::clogit(case_ ~ buneaII_NDVI_aug20 + buneaII_broad_2000 + buneaII_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI and broad interaction with mixed buneaII
buneaIImod9.i<- survival::clogit(case_ ~ buneaII_NDVI_aug20*buneaII_broad_2000 + buneaII_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI and mixed interaction with broad buneaII
buneaIImod9.ii<- survival::clogit(case_ ~ buneaII_NDVI_aug20*buneaII_mixed_2000 + buneaII_broad_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI + broad + mixed buneaII
buneaIImod10 <- survival::clogit(case_ ~ buneaII_NDVI_mar21 + buneaII_broad_2000 + buneaII_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI and broad interaction with mixed buneaII
buneaIImod10.i<- survival::clogit(case_ ~ buneaII_NDVI_mar21*buneaII_broad_2000 + buneaII_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#NDVI and mixed interaction with broad buneaII
buneaIImod10.ii<- survival::clogit(case_ ~ buneaII_NDVI_mar21*buneaII_mixed_2000 + buneaII_broad_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#broad and mixed
buneaIImod11 <- survival::clogit(case_ ~ buneaII_broad_2000 + buneaII_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#Natural grassland +hm grassland
buneaIImod12 <- survival::clogit(case_ ~ buneaII_ngrass_2000 + buneaII_hm_grass_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#natural grassland and human managed grassland interaction
buneaIImod12.i <- survival::clogit(case_ ~ buneaII_ngrass_2000*buneaII_hm_grass_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#Mixed forest+ transition habitat
buneaIImod13 <- survival::clogit(case_ ~ buneaII_mixed_2000 + buneaII_transitional_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#Broad + mixed + natgrass + hmgrass + transitional
buneaIImod14 <- survival::clogit(case_ ~ buneaII_broad_2000 + buneaII_mixed_2000 + buneaII_ngrass_2000 + buneaII_hm_grass_2000 + buneaII_transitional_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#broad and mixed interaction with natural grasslands and human managed grassland
buneaIImod14.i <- survival::clogit(case_ ~ buneaII_broad_2000*buneaII_mixed_2000 + buneaII_ngrass_2000 + buneaII_hm_grass_2000 + buneaII_transitional_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#natural grasslands and human managed grasslands interaction with broad and mixed
buneaIImod14.ii <- survival::clogit(case_ ~ buneaII_broad_2000 + buneaII_mixed_2000 + buneaII_ngrass_2000*buneaII_hm_grass_2000 + buneaII_transitional_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
buneaIImod15 <- survival::clogit(case_ ~ buneaII_broad_2000 + buneaII_mixed_2000 + buneaII_ngrass_2000 + buneaII_hm_grass_2000 + buneaII_transitional_2000 + buneaII_distance_to_riparian + buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#Broad + mixed + distance to roads
buneaIImod16 <- survival::clogit(case_ ~ buneaII_broad_2000 + buneaII_mixed_2000 + buneaII_distance_to_roads + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#TRI + slope + elevation + aspect
buneaIImod17 <- survival::clogit(case_ ~ buneaII_TRI_50 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#TRI and elevation interaction with slope + aspect
buneaIImod17.i <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_elevation + buneaII_slope_500 + buneaII_aspect_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#TRI + slope + elevation + aspect + ndvi + ndwi
buneaIImod18 <- survival::clogit(case_ ~ buneaII_TRI_50 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_aug20 + buneaII_NDWI_aug20 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#TRI + slope + elevation + aspect + NDVI winter+ NDWI winter
buneaIImod19 <- survival::clogit(case_ ~ buneaII_TRI_50 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#TRI + slope + elevation + aspect +forest mixed + forest broad
buneaIImod20 <- survival::clogit(case_ ~ buneaII_TRI_50 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_mixed_2000 + buneaII_broad_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#forest edge and roads
buneaIImod21 <- survival::clogit(case_ ~  buneaII_distance_to_forest_edge*buneaII_distance_to_roads + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
summary(buneaIImod21)
#forest edge and broad
buneaIImod22 <- survival::clogit(case_ ~ buneaII_distance_to_forest_edge + buneaII_broad_2000 + buneaII_distance_to_forest_edge*buneaII_broad_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#riparian zones and elevation
buneaIImod23 <- survival::clogit(case_ ~ buneaII_distance_to_riparian + buneaII_elevation + buneaII_distance_to_riparian* buneaII_elevation + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#broadleaf forest and elevation (with TRI and NDVI)
buneaIImod24 <- survival::clogit(case_ ~ buneaII_broad_2000*buneaII_elevation + buneaII_TRI_50 + buneaII_NDVI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
buneaIImod24.1 <- survival::clogit(case_ ~ buneaII_broad_2000*buneaII_elevation + buneaII_TRI_50 + buneaII_NDVI_aug20 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#natural grasslands and distance to forest edge (with NDVI and elevation)
buneaIImod25 <- survival::clogit(case_ ~ buneaII_ngrass_2000*buneaII_distance_to_forest_edge + buneaII_NDVI_mar21 + buneaII_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#transitional and distance to forest edge (with elevation and aspect and TRI)
buneaIImod26 <- survival::clogit(case_ ~ buneaII_transitional_2000*buneaII_distance_to_forest_edge + buneaII_elevation + buneaII_aspect_2000 + buneaII_TRI_50 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#transitional and mixed forest (with broadleaf and elevation)
buneaIImod27 <- survival::clogit(case_ ~ buneaII_transitional_2000*buneaII_mixed_2000 + buneaII_elevation + buneaII_broad_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#transitional and broadleaf (with mixed and elevation)
buneaIImod28 <- survival::clogit(case_ ~ buneaII_transitional_2000*buneaII_broad_2000 + buneaII_elevation + buneaII_mixed_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to roads and broadleaf (with NDVI and elevation)
buneaIImod29 <- survival::clogit(case_ ~ buneaII_distance_to_roads*buneaII_broad_2000 + buneaII_elevation + buneaII_NDVI_mar21 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to roads and mixed (with NDVI and elevation)
buneaIImod30 <- survival::clogit(case_ ~ buneaII_distance_to_roads*buneaII_mixed_2000 + buneaII_elevation + buneaII_NDVI_mar21 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
buneaIImod31 <- survival::clogit(case_ ~ buneaII_distance_to_roads*buneaII_ngrass_2000 + buneaII_elevation + buneaII_NDVI_mar21 + buneaII_TRI_50 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
buneaIImod32 <- survival::clogit(case_ ~ buneaII_distance_to_roads*buneaII_transitional_2000 + buneaII_elevation + buneaII_NDVI_mar21 + buneaII_TRI_50 + buneaII_ngrass_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
buneaIImod33 <- survival::clogit(case_ ~ buneaII_distance_to_release_sites*buneaII_ngrass_2000 + buneaII_broad_2000 + buneaII_NDVI_mar21 + buneaII_mixed_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
buneaIImod34 <- survival::clogit(case_ ~ buneaII_distance_to_release_sites*buneaII_broad_2000 + buneaII_ngrass_2000 + buneaII_NDVI_mar21 + buneaII_mixed_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to release sites and mixed (with grasslands, broad and NDVI)
buneaIImod35 <- survival::clogit(case_ ~ buneaII_distance_to_release_sites*buneaII_mixed_2000 + buneaII_ngrass_2000 + buneaII_NDVI_mar21 + buneaII_broad_2000 + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and broadleaf (with buneaIImod19-slope, elevation, aspect, NDVI and NDWI)
buneaIImod36 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_broad_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and natgrasslands (with buneaIImod19-slope, elevation, aspect, NDVI and NDWI)
buneaIImod37 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_ngrass_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and mixed (with buneaIImod19-slope, elevation, aspect, NDVI and NDWI)
buneaIImod38 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_mixed_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and transitional habitat (with buneaIImod19-slope, elevation, aspect, NDVI and NDWI)
buneaIImod39 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_transitional_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to forest edge and NDVI (with elevation, slope and TRI)
buneaIImod40 <- survival::clogit(case_ ~ buneaII_distance_to_forest_edge*buneaII_NDVI_mar21 + buneaII_slope_500 + buneaII_elevation + buneaII_TRI_50 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to release sites and TRI (with aspect, elevation and slope)
buneaIImod41 <- survival::clogit(case_ ~ buneaII_distance_to_release_sites*buneaII_TRI_50 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to release sites and elevation (with aspect, TRI and slope)
buneaIImod42 <- survival::clogit(case_ ~ buneaII_distance_to_release_sites*buneaII_elevation + buneaII_slope_500 + buneaII_TRI_50 + buneaII_aspect_2000 + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
buneaIImod43 <- survival::clogit(case_ ~ buneaII_distance_to_forest_edge*buneaII_broad_2000 + buneaII_mixed_2000 + buneaII_NDVI_mar21 + buneaII_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
buneaIImod44 <- survival::clogit(case_ ~ buneaII_distance_to_forest_edge*buneaII_mixed_2000 + buneaII_broad_2000 + buneaII_NDVI_mar21 + buneaII_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
#Elevation and TRI (with ndvi, slope and aspect)
buneaIImod45 <- survival::clogit(case_ ~ buneaII_elevation*buneaII_TRI_50+ buneaII_broad_2000 + buneaII_NDVI_mar21 + buneaII_elevation + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
buneaIImod46 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_broad_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + buneaII_distance_to_forest_edge + buneaII_distance_to_release_sites + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
buneaIImod47 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_ngrass_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + buneaII_distance_to_forest_edge + buneaII_distance_to_release_sites + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
buneaIImod48 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_mixed_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + buneaII_distance_to_forest_edge + buneaII_distance_to_release_sites + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
buneaIImod49 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_transitional_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21+ buneaII_distance_to_forest_edge + buneaII_distance_to_release_sites + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneaIImod50 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_broad_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneaIImod51 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_ngrass_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneaIImod52 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_mixed_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21 + buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
buneaIImod53 <- survival::clogit(case_ ~ buneaII_TRI_50*buneaII_transitional_2000 + buneaII_slope_500 + buneaII_elevation + buneaII_aspect_2000 + buneaII_NDVI_mar21 + buneaII_NDWI_mar21+ buneaII_distance_to_forest_edge + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.buneaII)
summary(buneaIImod1)
summary(buneaIImod2)
summary(buneaIImod3)
summary(buneaIImod3.i)
summary(buneaIImod4)
summary(buneaIImod5)
summary(buneaIImod6)
summary(buneaIImod7)
summary(buneaIImod8)
summary(buneaIImod8.i)
summary(buneaIImod9)
summary(buneaIImod9.i)
summary(buneaIImod9.ii)
summary(buneaIImod10)
summary(buneaIImod10.i)
summary(buneaIImod10.ii)
summary(buneaIImod11)
summary(buneaIImod12)
summary(buneaIImod12.i)
summary(buneaIImod13)
summary(buneaIImod14)
summary(buneaIImod14.i)
summary(buneaIImod14.ii)
summary(buneaIImod15)
summary(buneaIImod16)
summary(buneaIImod17)
summary(buneaIImod17.i)
summary(buneaIImod18)
summary(buneaIImod19)
summary(buneaIImod20)
summary(buneaIImod21)
summary(buneaIImod22)
summary(buneaIImod23)
summary(buneaIImod24)
summary(buneaIImod25)
summary(buneaIImod26)
summary(buneaIImod27)
summary(buneaIImod28)
summary(buneaIImod29)
summary(buneaIImod30)
summary(buneaIImod31)
summary(buneaIImod32)
summary(buneaIImod33)
summary(buneaIImod34)
summary(buneaIImod35)
summary(buneaIImod36)
summary(buneaIImod37)
summary(buneaIImod38)
summary(buneaIImod39)
summary(buneaIImod40)
summary(buneaIImod41)
summary(buneaIImod42)
summary(buneaIImod43)
summary(buneaIImod44)
summary(buneaIImod45)
summary(buneaIImod46)
summary(buneaIImod47)
summary(buneaIImod48)
summary(buneaIImod49)
summary(buneaIImod50)
summary(buneaIImod51)
summary(buneaIImod52)
summary(buneaIImod53)
```

AIC
```{r buneaII AIC}
buneaIImodsel <- model.sel(buneaIImod1,buneaIImod2,buneaIImod3,buneaIImod3.i,buneaIImod4,buneaIImod5,buneaIImod6,buneaIImod7,buneaIImod8,buneaIImod8.i,buneaIImod9,buneaIImod9.i,buneaIImod9.ii,buneaIImod10,buneaIImod10.i,buneaIImod10.ii,buneaIImod11,buneaIImod12,buneaIImod12.i,buneaIImod13,buneaIImod14,buneaIImod14.i,buneaIImod14.ii,buneaIImod15,buneaIImod16,buneaIImod17,buneaIImod17.i,buneaIImod18,buneaIImod19,buneaIImod20,buneaIImod21, buneaIImod22, buneaIImod23, buneaIImod24, buneaIImod25, buneaIImod26, buneaIImod27, buneaIImod28,buneaIImod29,buneaIImod30,buneaIImod31,buneaIImod32,buneaIImod33,buneaIImod34,buneaIImod35,buneaIImod36,buneaIImod37,buneaIImod38,buneaIImod39,buneaIImod40,buneaIImod41,buneaIImod42,buneaIImod43,buneaIImod44,buneaIImod45,buneaIImod46,buneaIImod47,buneaIImod48,buneaIImod49,buneaIImod50,buneaIImod51,buneaIImod52,buneaIImod53)
buneaIImodsel #buneaIImod18 and 7
```
Leresti I and II
tracks
```{r leresti I and II tracks}
#subset lerestiI
lerestiI_tracks <- LerestiI %>%
  dplyr::select(x = longitude, y = latitude,
                t = t, id = Collar.ID)
#subset lerestiII
lerestiII_tracks <- LerestiII %>%
  dplyr::select(x = longitude, y = latitude,
                t = t, id = Collar.ID)
#remove NAs
lerestiII_tracks <-na.omit(lerestiII_tracks)
lerestiI_tracks <-na.omit(lerestiI_tracks)
#nest by id
nested_lerestiI <- 
  lerestiI_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_lerestiI)
#nest by id
nested_lerestiII <- 
  lerestiII_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_lerestiII)
```
Step lengths
```{r leresti I and II step lengths}
step.lengths.lerestiI <- unlist(map(nested_lerestiI$track, step_lengths))
hist(step.lengths.lerestiI, breaks = 20, main="Histogram of step lengths lerestiI", xlab="Step lengths")
step.lengths.lerestiII <- unlist(map(nested_lerestiII$track, step_lengths))
hist(step.lengths.lerestiII, breaks = 20, main="Histogram of step lengths lerestiII", xlab="Step lengths")
```

```{r leresti I and II true steps}
true.steps.lerestiI <- map(nested_lerestiI$track, steps)
head(true.steps.lerestiI[[1]])
true.steps.lerestiII <- map(nested_lerestiI$track, steps)
head(true.steps.lerestiII[[1]])
```
Create random steps
Generating 5 random steps per used step.
.id="id" creates a new column with the id of the list so we can still separate data by animal.
```{r leresti I and II random steps}
true.random.steps.lerestiI <- map(true.steps.lerestiI, random_steps, n=5)
all.steps.lerestiI <- bind_rows(true.random.steps.lerestiI, .id="id")
all.steps.lerestiI
true.random.steps.lerestiII <- map(true.steps.lerestiII, random_steps, n=5)
all.steps.lerestiII <- bind_rows(true.random.steps.lerestiII, .id="id")
all.steps.lerestiII
```
distribution of turning angles for used steps only
```{r leresti I and II turning angles}
with(all.steps.lerestiI, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles lerestiI", xlab="turning angle"))
with(all.steps.lerestiII, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles lerestiII", xlab="turning angle"))
```

```{r leresti I and II clean up}
steps.sp.lerestiI <- all.steps.lerestiI
steps.sp.lerestiII <- all.steps.lerestiII
#remove NA
steps.sp.lerestiI <- na.omit(steps.sp.lerestiI)
steps.sp.lerestiII <- na.omit(steps.sp.lerestiII)
coordinates(steps.sp.lerestiI) <- ~x2_+y2_
proj4string(steps.sp.lerestiI) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
coordinates(steps.sp.lerestiII) <- ~x2_+y2_
proj4string(steps.sp.lerestiII) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
```
Extract habitat covariate data
lerestiI
```{r leresti I covariate extraction}
lerestiI_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.lerestiI)
lerestiI_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.lerestiI)
lerestiI_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.lerestiI)
lerestiI_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.lerestiI)
lerestiI_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.lerestiI)
lerestiI_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.lerestiI)
lerestiI_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.lerestiI)
lerestiI_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.lerestiI)
lerestiI_elevation <- raster::extract(elevation_scaled, steps.sp.lerestiI)
lerestiI_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.lerestiI)
lerestiI_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.lerestiI)
lerestiI_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.lerestiI)
lerestiI_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.lerestiI)
lerestiI_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.lerestiI)
lerestiI_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.lerestiI)
lerestiI_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.lerestiI)
lerestiI_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.lerestiI)

covariates_lerestiI <- cbind(lerestiI_distance_to_roads,lerestiI_distance_to_forest_edge,lerestiI_distance_to_riparian,lerestiI_distance_to_release_sites,lerestiI_NDVI_aug20,lerestiI_NDVI_mar21,lerestiI_NDWI_aug20,lerestiI_NDWI_mar21,lerestiI_elevation,lerestiI_TRI_50,lerestiI_broad_2000,lerestiI_mixed_2000,lerestiI_ngrass_2000,lerestiI_hm_grass_2000,lerestiI_transitional_2000,lerestiI_aspect_2000,lerestiI_slope_500)
```
lerestiII
```{r leresti II covariate extraction}
lerestiII_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.lerestiII)
lerestiII_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.lerestiII)
lerestiII_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.lerestiII)
lerestiII_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.lerestiII)
lerestiII_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.lerestiII)
lerestiII_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.lerestiII)
lerestiII_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.lerestiII)
lerestiII_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.lerestiII)
lerestiII_elevation <- raster::extract(elevation_scaled, steps.sp.lerestiII)
lerestiII_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.lerestiII)
lerestiII_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.lerestiII)
lerestiII_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.lerestiII)
lerestiII_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.lerestiII)
lerestiII_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.lerestiII)
lerestiII_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.lerestiII)
lerestiII_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.lerestiII)
lerestiII_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.lerestiII)

covariates_lerestiII <- cbind(lerestiII_distance_to_roads,lerestiII_distance_to_forest_edge,lerestiII_distance_to_riparian,lerestiII_distance_to_release_sites,lerestiII_NDVI_aug20,lerestiII_NDVI_mar21,lerestiII_NDWI_aug20,lerestiII_NDWI_mar21,lerestiII_elevation,lerestiII_TRI_50,lerestiII_broad_2000,lerestiII_mixed_2000,lerestiII_ngrass_2000,lerestiII_hm_grass_2000,lerestiII_transitional_2000,lerestiII_aspect_2000,lerestiII_slope_500)
```
add the covariate data to our SpatialPointsDataFrame of used and random steps
```{r leresti I spatial df}
steps.sp.lerestiI$lerestiI_distance_to_roads <- covariates_lerestiI[,1]
steps.sp.lerestiI$lerestiI_distance_to_forest_edge <- covariates_lerestiI[,2]
steps.sp.lerestiI$lerestiI_distance_to_riparian <- covariates_lerestiI[,3]
steps.sp.lerestiI$lerestiI_distance_to_release_sites <- covariates_lerestiI[,4]
steps.sp.lerestiI$lerestiI_NDVI_aug20 <- covariates_lerestiI[,5]
steps.sp.lerestiI$lerestiI_NDVI_mar21 <- covariates_lerestiI[,6]
steps.sp.lerestiI$lerestiI_NDWI_aug20 <- covariates_lerestiI[,7]
steps.sp.lerestiI$lerestiI_NDWI_mar21 <- covariates_lerestiI[,8]
steps.sp.lerestiI$lerestiI_elevation <- covariates_lerestiI[,9]
steps.sp.lerestiI$lerestiI_TRI_50 <- covariates_lerestiI[,10]
steps.sp.lerestiI$lerestiI_broad_2000 <- covariates_lerestiI[,11]
steps.sp.lerestiI$lerestiI_mixed_2000 <- covariates_lerestiI[,12]
steps.sp.lerestiI$lerestiI_ngrass_2000 <- covariates_lerestiI[,13]
steps.sp.lerestiI$lerestiI_hm_grass_2000 <- covariates_lerestiI[,14]
steps.sp.lerestiI$lerestiI_transitional_2000 <- covariates_lerestiI[,15]
steps.sp.lerestiI$lerestiI_aspect_2000 <- covariates_lerestiI[,16]
steps.sp.lerestiI$lerestiI_slope_500 <- covariates_lerestiI[,17]

head(steps.sp.lerestiI)
```
lerestiII
```{r leresti II spatial df}
steps.sp.lerestiII$lerestiII_distance_to_roads <- covariates_lerestiII[,1]
steps.sp.lerestiII$lerestiII_distance_to_forest_edge <- covariates_lerestiII[,2]
steps.sp.lerestiII$lerestiII_distance_to_riparian <- covariates_lerestiII[,3]
steps.sp.lerestiII$lerestiII_distance_to_release_sites <- covariates_lerestiII[,4]
steps.sp.lerestiII$lerestiII_NDVI_aug20 <- covariates_lerestiII[,5]
steps.sp.lerestiII$lerestiII_NDVI_mar21 <- covariates_lerestiII[,6]
steps.sp.lerestiII$lerestiII_NDWI_aug20 <- covariates_lerestiII[,7]
steps.sp.lerestiII$lerestiII_NDWI_mar21 <- covariates_lerestiII[,8]
steps.sp.lerestiII$lerestiII_elevation <- covariates_lerestiII[,9]
steps.sp.lerestiII$lerestiII_TRI_50 <- covariates_lerestiII[,10]
steps.sp.lerestiII$lerestiII_broad_2000 <- covariates_lerestiII[,11]
steps.sp.lerestiII$lerestiII_mixed_2000 <- covariates_lerestiII[,12]
steps.sp.lerestiII$lerestiII_ngrass_2000 <- covariates_lerestiII[,13]
steps.sp.lerestiII$lerestiII_hm_grass_2000 <- covariates_lerestiII[,14]
steps.sp.lerestiII$lerestiII_transitional_2000 <- covariates_lerestiII[,15]
steps.sp.lerestiII$lerestiII_aspect_2000 <- covariates_lerestiII[,16]
steps.sp.lerestiII$lerestiII_slope_500 <- covariates_lerestiII[,17]

head(steps.sp.lerestiII)
```
```{r}
#Export
write.csv(steps.sp.lerestiI, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.lerestiI.csv", row.names = FALSE)
write.csv(steps.sp.lerestiII, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.lerestiII.csv", row.names = FALSE)
```
Models
lerestiI
```{r lerestiI models}
#distance to riparian and distance to forest
lerestiImod1 <- survival::clogit(case_ ~ lerestiI_distance_to_riparian + lerestiI_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
coef(lerestiImod1)
#Distance to roads + distance to forests
lerestiImod2 <- survival::clogit(case_ ~lerestiI_distance_to_roads + lerestiI_distance_to_forest_edge + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#Distance to rip + distance to forests + distance to roads
lerestiImod3 <- survival::clogit(case_ ~lerestiI_distance_to_riparian + lerestiI_distance_to_roads + lerestiI_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
##Distance to rip and distance to forests interaction with  distance to roads
lerestiImod3.i <- survival::clogit(case_ ~lerestiI_distance_to_riparian*lerestiI_distance_to_forest_edge + lerestiI_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#Distance to rip + distance to forests + distance to release sites 
lerestiImod4 <- survival::clogit(case_ ~ lerestiI_distance_to_riparian + lerestiI_distance_to_release_sites + lerestiI_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI + NDWI lerestiI
lerestiImod5 <- survival::clogit(case_ ~lerestiI_NDVI_aug20 + lerestiI_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI + NDWI march
lerestiImod6 <- survival::clogit(case_ ~ lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI + elevation lerestiI
lerestiImod7 <- survival::clogit(case_ ~ lerestiI_NDVI_aug20 + lerestiI_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI elevation interaction
lerestiImod7.i <- survival::clogit(case_ ~ lerestiI_NDVI_aug20*lerestiI_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI and elevation lerestiI
lerestiImod8 <- survival::clogit(case_ ~ lerestiI_NDVI_mar21 + lerestiI_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI and elevation interaction lerestiI
lerestiImod8.i <- survival::clogit(case_ ~ lerestiI_NDVI_mar21*lerestiI_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI + broad + mixed lerestiI
lerestiImod9 <- survival::clogit(case_ ~ lerestiI_NDVI_aug20 + lerestiI_broad_2000 + lerestiI_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI and broad interaction with mixed lerestiI
lerestiImod9.i<- survival::clogit(case_ ~ lerestiI_NDVI_aug20*lerestiI_broad_2000 + lerestiI_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI and mixed interaction with broad lerestiI
lerestiImod9.ii<- survival::clogit(case_ ~ lerestiI_NDVI_aug20*lerestiI_mixed_2000 + lerestiI_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI + broad + mixed lerestiI
lerestiImod10 <- survival::clogit(case_ ~ lerestiI_NDVI_mar21 + lerestiI_broad_2000 + lerestiI_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI and broad interaction with mixed lerestiI
lerestiImod10.i<- survival::clogit(case_ ~ lerestiI_NDVI_mar21*lerestiI_broad_2000 + lerestiI_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#NDVI and mixed interaction with broad lerestiI
lerestiImod10.ii<- survival::clogit(case_ ~ lerestiI_NDVI_mar21*lerestiI_mixed_2000 + lerestiI_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#broad and mixed
lerestiImod11 <- survival::clogit(case_ ~ lerestiI_broad_2000 + lerestiI_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#Natural grassland +hm grassland
lerestiImod12 <- survival::clogit(case_ ~ lerestiI_ngrass_2000 + lerestiI_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#natural grassland and human managed grassland interaction
lerestiImod12.i <- survival::clogit(case_ ~ lerestiI_ngrass_2000*lerestiI_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#Mixed forest+ transition habitat
lerestiImod13 <- survival::clogit(case_ ~ lerestiI_mixed_2000 + lerestiI_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#Broad + mixed + natgrass + hmgrass + transitional
lerestiImod14 <- survival::clogit(case_ ~ lerestiI_broad_2000 + lerestiI_mixed_2000 + lerestiI_ngrass_2000 + lerestiI_hm_grass_2000 + lerestiI_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#broad and mixed interaction with natural grasslands and human managed grassland
lerestiImod14.i <- survival::clogit(case_ ~ lerestiI_broad_2000*lerestiI_mixed_2000 + lerestiI_ngrass_2000 + lerestiI_hm_grass_2000 + lerestiI_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#natural grasslands and human managed grasslands interaction with broad and mixed
lerestiImod14.ii <- survival::clogit(case_ ~ lerestiI_broad_2000 + lerestiI_mixed_2000 + lerestiI_ngrass_2000*lerestiI_hm_grass_2000 + lerestiI_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
lerestiImod15 <- survival::clogit(case_ ~ lerestiI_broad_2000 + lerestiI_mixed_2000 + lerestiI_ngrass_2000 + lerestiI_hm_grass_2000 + lerestiI_transitional_2000 + lerestiI_distance_to_riparian + lerestiI_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#Broad + mixed + distance to roads
lerestiImod16 <- survival::clogit(case_ ~ lerestiI_broad_2000 + lerestiI_mixed_2000 + lerestiI_distance_to_roads + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#TRI + slope + elevation + aspect
lerestiImod17 <- survival::clogit(case_ ~ lerestiI_TRI_50 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#TRI and elevation interaction with slope + aspect
lerestiImod17.i <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_elevation + lerestiI_slope_500 + lerestiI_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#TRI + slope + elevation + aspect + ndvi + ndwi
lerestiImod18 <- survival::clogit(case_ ~ lerestiI_TRI_50 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_aug20 + lerestiI_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#TRI + slope + elevation + aspect + NDVI lerestiI + NDWI lerestiI
lerestiImod19 <- survival::clogit(case_ ~ lerestiI_TRI_50 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#TRI + slope + elevation + aspect +forest mixed + forest broad
lerestiImod20 <- survival::clogit(case_ ~ lerestiI_TRI_50 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_mixed_2000 + lerestiI_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#forest edge and roads
lerestiImod21 <- survival::clogit(case_ ~  lerestiI_distance_to_forest_edge*lerestiI_distance_to_roads + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
summary(lerestiImod21)
#forest edge and broad
lerestiImod22 <- survival::clogit(case_ ~ lerestiI_distance_to_forest_edge + lerestiI_broad_2000 + lerestiI_distance_to_forest_edge*lerestiI_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#riparian zones and elevation
lerestiImod23 <- survival::clogit(case_ ~ lerestiI_distance_to_riparian + lerestiI_elevation + lerestiI_distance_to_riparian* lerestiI_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#broadleaf forest and elevation (with TRI and NDVI)
lerestiImod24 <- survival::clogit(case_ ~ lerestiI_broad_2000*lerestiI_elevation + lerestiI_TRI_50 + lerestiI_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
lerestiImod24.1 <- survival::clogit(case_ ~ lerestiI_broad_2000*lerestiI_elevation + lerestiI_TRI_50 + lerestiI_NDVI_aug20 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#natural grasslands and distance to forest edge (with NDVI and elevation)
lerestiImod25 <- survival::clogit(case_ ~ lerestiI_ngrass_2000*lerestiI_distance_to_forest_edge + lerestiI_NDVI_mar21 + lerestiI_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#transitional and distance to forest edge (with elevation and aspect and TRI)
lerestiImod26 <- survival::clogit(case_ ~ lerestiI_transitional_2000*lerestiI_distance_to_forest_edge + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#transitional and mixed forest (with broadleaf and elevation)
lerestiImod27 <- survival::clogit(case_ ~ lerestiI_transitional_2000*lerestiI_mixed_2000 + lerestiI_elevation + lerestiI_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#transitional and broadleaf (with mixed and elevation)
lerestiImod28 <- survival::clogit(case_ ~ lerestiI_transitional_2000*lerestiI_broad_2000 + lerestiI_elevation + lerestiI_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to roads and broadleaf (with NDVI and elevation)
lerestiImod29 <- survival::clogit(case_ ~ lerestiI_distance_to_roads*lerestiI_broad_2000 + lerestiI_elevation + lerestiI_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to roads and mixed (with NDVI and elevation)
lerestiImod30 <- survival::clogit(case_ ~ lerestiI_distance_to_roads*lerestiI_mixed_2000 + lerestiI_elevation + lerestiI_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
lerestiImod31 <- survival::clogit(case_ ~ lerestiI_distance_to_roads*lerestiI_ngrass_2000 + lerestiI_elevation + lerestiI_NDVI_mar21 + lerestiI_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
lerestiImod32 <- survival::clogit(case_ ~ lerestiI_distance_to_roads*lerestiI_transitional_2000 + lerestiI_elevation + lerestiI_NDVI_mar21 + lerestiI_TRI_50 + lerestiI_ngrass_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
lerestiImod33 <- survival::clogit(case_ ~ lerestiI_distance_to_release_sites*lerestiI_ngrass_2000 + lerestiI_broad_2000 + lerestiI_NDVI_mar21 + lerestiI_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
lerestiImod34 <- survival::clogit(case_ ~ lerestiI_distance_to_release_sites*lerestiI_broad_2000 + lerestiI_ngrass_2000 + lerestiI_NDVI_mar21 + lerestiI_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to release sites and mixed (with grasslands, broad and NDVI)
lerestiImod35 <- survival::clogit(case_ ~ lerestiI_distance_to_release_sites*lerestiI_mixed_2000 + lerestiI_ngrass_2000 + lerestiI_NDVI_mar21 + lerestiI_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and broadleaf (with lerestiImod19-slope, elevation, aspect, NDVI and NDWI)
lerestiImod36 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_broad_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and natgrasslands (with lerestiImod19-slope, elevation, aspect, NDVI and NDWI)
lerestiImod37 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_ngrass_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and mixed (with lerestiImod19-slope, elevation, aspect, NDVI and NDWI)
lerestiImod38 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_mixed_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and transitional habitat (with lerestiImod19-slope, elevation, aspect, NDVI and NDWI)
lerestiImod39 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_transitional_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to forest edge and NDVI (with elevation, slope and TRI)
lerestiImod40 <- survival::clogit(case_ ~ lerestiI_distance_to_forest_edge*lerestiI_NDVI_mar21 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_TRI_50 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to release sites and TRI (with aspect, elevation and slope)
lerestiImod41 <- survival::clogit(case_ ~ lerestiI_distance_to_release_sites*lerestiI_TRI_50 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to release sites and elevation (with aspect, TRI and slope)
lerestiImod42 <- survival::clogit(case_ ~ lerestiI_distance_to_release_sites*lerestiI_elevation + lerestiI_slope_500 + lerestiI_TRI_50 + lerestiI_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
lerestiImod43 <- survival::clogit(case_ ~ lerestiI_distance_to_forest_edge*lerestiI_broad_2000 + lerestiI_mixed_2000 + lerestiI_NDVI_mar21 + lerestiI_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
lerestiImod44 <- survival::clogit(case_ ~ lerestiI_distance_to_forest_edge*lerestiI_mixed_2000 + lerestiI_broad_2000 + lerestiI_NDVI_mar21 + lerestiI_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
#Elevation and TRI (with ndvi, slope and aspect)
lerestiImod45 <- survival::clogit(case_ ~ lerestiI_elevation*lerestiI_TRI_50+ lerestiI_broad_2000 + lerestiI_NDVI_mar21 + lerestiI_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
lerestiImod46 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_broad_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + lerestiI_distance_to_forest_edge + lerestiI_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
lerestiImod47 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_ngrass_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + lerestiI_distance_to_forest_edge + lerestiI_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
lerestiImod48 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_mixed_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + lerestiI_distance_to_forest_edge + lerestiI_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
lerestiImod49 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_transitional_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21+ lerestiI_distance_to_forest_edge + lerestiI_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestiImod50 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_broad_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + lerestiI_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestiImod51 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_ngrass_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + lerestiI_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestiImod52 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_mixed_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21 + lerestiI_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestiImod53 <- survival::clogit(case_ ~ lerestiI_TRI_50*lerestiI_transitional_2000 + lerestiI_slope_500 + lerestiI_elevation + lerestiI_aspect_2000 + lerestiI_NDVI_mar21 + lerestiI_NDWI_mar21+ lerestiI_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiI)
summary(lerestiImod1)
summary(lerestiImod2)
summary(lerestiImod3)
summary(lerestiImod3.i)
summary(lerestiImod4)
summary(lerestiImod5)
summary(lerestiImod6)
summary(lerestiImod7)
summary(lerestiImod8)
summary(lerestiImod8.i)
summary(lerestiImod9)
summary(lerestiImod9.i)
summary(lerestiImod9.ii)
summary(lerestiImod10)
summary(lerestiImod10.i)
summary(lerestiImod10.ii)
summary(lerestiImod11)
summary(lerestiImod12)
summary(lerestiImod12.i)
summary(lerestiImod13)
summary(lerestiImod14)
summary(lerestiImod14.i)
summary(lerestiImod14.ii)
summary(lerestiImod15)
summary(lerestiImod16)
summary(lerestiImod17)
summary(lerestiImod17.i)
summary(lerestiImod18)
summary(lerestiImod19)
summary(lerestiImod20)
summary(lerestiImod21)
summary(lerestiImod22)
summary(lerestiImod23)
summary(lerestiImod24)
summary(lerestiImod25)
summary(lerestiImod26)
summary(lerestiImod27)
summary(lerestiImod28)
summary(lerestiImod29)
summary(lerestiImod30)
summary(lerestiImod31)
summary(lerestiImod32)
summary(lerestiImod33)
summary(lerestiImod34)
summary(lerestiImod35)
summary(lerestiImod36)
summary(lerestiImod37)
summary(lerestiImod38)
summary(lerestiImod39)
summary(lerestiImod40)
summary(lerestiImod41)
summary(lerestiImod42)
summary(lerestiImod43)
summary(lerestiImod44)
summary(lerestiImod45)
summary(lerestiImod46)
summary(lerestiImod47)
summary(lerestiImod48)
summary(lerestiImod49)
summary(lerestiImod50)
summary(lerestiImod51)
summary(lerestiImod52)
summary(lerestiImod53)
```

AIC
```{r lerestiI AIC}
lerestiImodsel <- model.sel(lerestiImod1,lerestiImod2,lerestiImod3,lerestiImod3.i,lerestiImod4,lerestiImod5,lerestiImod6,lerestiImod7,lerestiImod8,lerestiImod8.i,lerestiImod9,lerestiImod9.i,lerestiImod9.ii,lerestiImod10,lerestiImod10.i,lerestiImod10.ii,lerestiImod11,lerestiImod12,lerestiImod12.i,lerestiImod13,lerestiImod14,lerestiImod14.i,lerestiImod14.ii,lerestiImod15,lerestiImod16,lerestiImod17,lerestiImod17.i,lerestiImod18,lerestiImod19,lerestiImod20,lerestiImod21, lerestiImod22, lerestiImod23, lerestiImod24, lerestiImod25, lerestiImod26, lerestiImod27, lerestiImod28,lerestiImod29,lerestiImod30,lerestiImod31,lerestiImod32,lerestiImod33,lerestiImod34,lerestiImod35,lerestiImod36,lerestiImod37,lerestiImod38,lerestiImod39,lerestiImod40,lerestiImod41,lerestiImod42,lerestiImod43,lerestiImod44,lerestiImod45,lerestiImod46,lerestiImod47,lerestiImod48,lerestiImod49,lerestiImod50,lerestiImod51,lerestiImod52,lerestiImod53)
lerestiImodsel #lerestiImod48 and 52
```
Models
lerestiII
```{r lerestiII models}
#distance to riparian and distance to forest
lerestiIImod1 <- survival::clogit(case_ ~ lerestiII_distance_to_riparian + lerestiII_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
coef(lerestiIImod1)
#Distance to roads + distance to forests
lerestiIImod2 <- survival::clogit(case_ ~lerestiII_distance_to_roads + lerestiII_distance_to_forest_edge + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#Distance to rip + distance to forests + distance to roads
lerestiIImod3 <- survival::clogit(case_ ~lerestiII_distance_to_riparian + lerestiII_distance_to_roads + lerestiII_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
##Distance to rip and distance to forests interaction with  distance to roads
lerestiIImod3.i <- survival::clogit(case_ ~lerestiII_distance_to_riparian*lerestiII_distance_to_forest_edge + lerestiII_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#Distance to rip + distance to forests + distance to release sites 
lerestiIImod4 <- survival::clogit(case_ ~ lerestiII_distance_to_riparian + lerestiII_distance_to_release_sites + lerestiII_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI + NDWI lerestiII
lerestiIImod5 <- survival::clogit(case_ ~lerestiII_NDVI_aug20 + lerestiII_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI + NDWI march
lerestiIImod6 <- survival::clogit(case_ ~ lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI + elevation lerestiII
lerestiIImod7 <- survival::clogit(case_ ~ lerestiII_NDVI_aug20 + lerestiII_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI elevation interaction
lerestiIImod7.i <- survival::clogit(case_ ~ lerestiII_NDVI_aug20*lerestiII_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI and elevation lerestiII
lerestiIImod8 <- survival::clogit(case_ ~ lerestiII_NDVI_mar21 + lerestiII_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI and elevation interaction lerestiII
lerestiIImod8.i <- survival::clogit(case_ ~ lerestiII_NDVI_mar21*lerestiII_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI + broad + mixed lerestiII
lerestiIImod9 <- survival::clogit(case_ ~ lerestiII_NDVI_aug20 + lerestiII_broad_2000 + lerestiII_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI and broad interaction with mixed lerestiII
lerestiIImod9.i<- survival::clogit(case_ ~ lerestiII_NDVI_aug20*lerestiII_broad_2000 + lerestiII_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI and mixed interaction with broad lerestiII
lerestiIImod9.ii<- survival::clogit(case_ ~ lerestiII_NDVI_aug20*lerestiII_mixed_2000 + lerestiII_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI + broad + mixed lerestiII
lerestiIImod10 <- survival::clogit(case_ ~ lerestiII_NDVI_mar21 + lerestiII_broad_2000 + lerestiII_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI and broad interaction with mixed lerestiII
lerestiIImod10.i<- survival::clogit(case_ ~ lerestiII_NDVI_mar21*lerestiII_broad_2000 + lerestiII_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#NDVI and mixed interaction with broad lerestiII
lerestiIImod10.ii<- survival::clogit(case_ ~ lerestiII_NDVI_mar21*lerestiII_mixed_2000 + lerestiII_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#broad and mixed
lerestiIImod11 <- survival::clogit(case_ ~ lerestiII_broad_2000 + lerestiII_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#Natural grassland +hm grassland
lerestiIImod12 <- survival::clogit(case_ ~ lerestiII_ngrass_2000 + lerestiII_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#natural grassland and human managed grassland interaction
lerestiIImod12.i <- survival::clogit(case_ ~ lerestiII_ngrass_2000*lerestiII_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#Mixed forest+ transition habitat
lerestiIImod13 <- survival::clogit(case_ ~ lerestiII_mixed_2000 + lerestiII_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#Broad + mixed + natgrass + hmgrass + transitional
lerestiIImod14 <- survival::clogit(case_ ~ lerestiII_broad_2000 + lerestiII_mixed_2000 + lerestiII_ngrass_2000 + lerestiII_hm_grass_2000 + lerestiII_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#broad and mixed interaction with natural grasslands and human managed grassland
lerestiIImod14.i <- survival::clogit(case_ ~ lerestiII_broad_2000*lerestiII_mixed_2000 + lerestiII_ngrass_2000 + lerestiII_hm_grass_2000 + lerestiII_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#natural grasslands and human managed grasslands interaction with broad and mixed
lerestiIImod14.ii <- survival::clogit(case_ ~ lerestiII_broad_2000 + lerestiII_mixed_2000 + lerestiII_ngrass_2000*lerestiII_hm_grass_2000 + lerestiII_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
lerestiIImod15 <- survival::clogit(case_ ~ lerestiII_broad_2000 + lerestiII_mixed_2000 + lerestiII_ngrass_2000 + lerestiII_hm_grass_2000 + lerestiII_transitional_2000 + lerestiII_distance_to_riparian + lerestiII_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#Broad + mixed + distance to roads
lerestiIImod16 <- survival::clogit(case_ ~ lerestiII_broad_2000 + lerestiII_mixed_2000 + lerestiII_distance_to_roads + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#TRI + slope + elevation + aspect
lerestiIImod17 <- survival::clogit(case_ ~ lerestiII_TRI_50 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#TRI and elevation interaction with slope + aspect
lerestiIImod17.i <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_elevation + lerestiII_slope_500 + lerestiII_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#TRI + slope + elevation + aspect + ndvi + ndwi
lerestiIImod18 <- survival::clogit(case_ ~ lerestiII_TRI_50 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_aug20 + lerestiII_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#TRI + slope + elevation + aspect + NDVI lerestiII + NDWI lerestiII
lerestiIImod19 <- survival::clogit(case_ ~ lerestiII_TRI_50 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#TRI + slope + elevation + aspect +forest mixed + forest broad
lerestiIImod20 <- survival::clogit(case_ ~ lerestiII_TRI_50 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_mixed_2000 + lerestiII_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#forest edge and roads
lerestiIImod21 <- survival::clogit(case_ ~  lerestiII_distance_to_forest_edge*lerestiII_distance_to_roads + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
summary(lerestiIImod21)
#forest edge and broad
lerestiIImod22 <- survival::clogit(case_ ~ lerestiII_distance_to_forest_edge + lerestiII_broad_2000 + lerestiII_distance_to_forest_edge*lerestiII_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#riparian zones and elevation
lerestiIImod23 <- survival::clogit(case_ ~ lerestiII_distance_to_riparian + lerestiII_elevation + lerestiII_distance_to_riparian* lerestiII_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#broadleaf forest and elevation (with TRI and NDVI)
lerestiIImod24 <- survival::clogit(case_ ~ lerestiII_broad_2000*lerestiII_elevation + lerestiII_TRI_50 + lerestiII_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
lerestiIImod24.1 <- survival::clogit(case_ ~ lerestiII_broad_2000*lerestiII_elevation + lerestiII_TRI_50 + lerestiII_NDVI_aug20 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#natural grasslands and distance to forest edge (with NDVI and elevation)
lerestiIImod25 <- survival::clogit(case_ ~ lerestiII_ngrass_2000*lerestiII_distance_to_forest_edge + lerestiII_NDVI_mar21 + lerestiII_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#transitional and distance to forest edge (with elevation and aspect and TRI)
lerestiIImod26 <- survival::clogit(case_ ~ lerestiII_transitional_2000*lerestiII_distance_to_forest_edge + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#transitional and mixed forest (with broadleaf and elevation)
lerestiIImod27 <- survival::clogit(case_ ~ lerestiII_transitional_2000*lerestiII_mixed_2000 + lerestiII_elevation + lerestiII_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#transitional and broadleaf (with mixed and elevation)
lerestiIImod28 <- survival::clogit(case_ ~ lerestiII_transitional_2000*lerestiII_broad_2000 + lerestiII_elevation + lerestiII_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to roads and broadleaf (with NDVI and elevation)
lerestiIImod29 <- survival::clogit(case_ ~ lerestiII_distance_to_roads*lerestiII_broad_2000 + lerestiII_elevation + lerestiII_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to roads and mixed (with NDVI and elevation)
lerestiIImod30 <- survival::clogit(case_ ~ lerestiII_distance_to_roads*lerestiII_mixed_2000 + lerestiII_elevation + lerestiII_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
lerestiIImod31 <- survival::clogit(case_ ~ lerestiII_distance_to_roads*lerestiII_ngrass_2000 + lerestiII_elevation + lerestiII_NDVI_mar21 + lerestiII_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
lerestiIImod32 <- survival::clogit(case_ ~ lerestiII_distance_to_roads*lerestiII_transitional_2000 + lerestiII_elevation + lerestiII_NDVI_mar21 + lerestiII_TRI_50 + lerestiII_ngrass_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
lerestiIImod33 <- survival::clogit(case_ ~ lerestiII_distance_to_release_sites*lerestiII_ngrass_2000 + lerestiII_broad_2000 + lerestiII_NDVI_mar21 + lerestiII_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
lerestiIImod34 <- survival::clogit(case_ ~ lerestiII_distance_to_release_sites*lerestiII_broad_2000 + lerestiII_ngrass_2000 + lerestiII_NDVI_mar21 + lerestiII_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to release sites and mixed (with grasslands, broad and NDVI)
lerestiIImod35 <- survival::clogit(case_ ~ lerestiII_distance_to_release_sites*lerestiII_mixed_2000 + lerestiII_ngrass_2000 + lerestiII_NDVI_mar21 + lerestiII_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and broadleaf (with lerestiIImod19-slope, elevation, aspect, NDVI and NDWI)
lerestiIImod36 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_broad_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and natgrasslands (with lerestiIImod19-slope, elevation, aspect, NDVI and NDWI)
lerestiIImod37 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_ngrass_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and mixed (with lerestiIImod19-slope, elevation, aspect, NDVI and NDWI)
lerestiIImod38 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_mixed_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and transitional habitat (with lerestiIImod19-slope, elevation, aspect, NDVI and NDWI)
lerestiIImod39 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_transitional_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to forest edge and NDVI (with elevation, slope and TRI)
lerestiIImod40 <- survival::clogit(case_ ~ lerestiII_distance_to_forest_edge*lerestiII_NDVI_mar21 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_TRI_50 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to release sites and TRI (with aspect, elevation and slope)
lerestiIImod41 <- survival::clogit(case_ ~ lerestiII_distance_to_release_sites*lerestiII_TRI_50 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to release sites and elevation (with aspect, TRI and slope)
lerestiIImod42 <- survival::clogit(case_ ~ lerestiII_distance_to_release_sites*lerestiII_elevation + lerestiII_slope_500 + lerestiII_TRI_50 + lerestiII_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
lerestiIImod43 <- survival::clogit(case_ ~ lerestiII_distance_to_forest_edge*lerestiII_broad_2000 + lerestiII_mixed_2000 + lerestiII_NDVI_mar21 + lerestiII_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
lerestiIImod44 <- survival::clogit(case_ ~ lerestiII_distance_to_forest_edge*lerestiII_mixed_2000 + lerestiII_broad_2000 + lerestiII_NDVI_mar21 + lerestiII_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
#Elevation and TRI (with ndvi, slope and aspect)
lerestiIImod45 <- survival::clogit(case_ ~ lerestiII_elevation*lerestiII_TRI_50+ lerestiII_broad_2000 + lerestiII_NDVI_mar21 + lerestiII_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
lerestiIImod46 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_broad_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + lerestiII_distance_to_forest_edge + lerestiII_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
lerestiIImod47 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_ngrass_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + lerestiII_distance_to_forest_edge + lerestiII_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
lerestiIImod48 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_mixed_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + lerestiII_distance_to_forest_edge + lerestiII_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
lerestiIImod49 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_transitional_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21+ lerestiII_distance_to_forest_edge + lerestiII_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestiIImod50 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_broad_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + lerestiII_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestiIImod51 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_ngrass_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + lerestiII_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestiIImod52 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_mixed_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21 + lerestiII_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
lerestiIImod53 <- survival::clogit(case_ ~ lerestiII_TRI_50*lerestiII_transitional_2000 + lerestiII_slope_500 + lerestiII_elevation + lerestiII_aspect_2000 + lerestiII_NDVI_mar21 + lerestiII_NDWI_mar21+ lerestiII_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.lerestiII)
summary(lerestiIImod1)
summary(lerestiIImod2)
summary(lerestiIImod3)
summary(lerestiIImod3.i)
summary(lerestiIImod4)
summary(lerestiIImod5)
summary(lerestiIImod6)
summary(lerestiIImod7)
summary(lerestiIImod8)
summary(lerestiIImod8.i)
summary(lerestiIImod9)
summary(lerestiIImod9.i)
summary(lerestiIImod9.ii)
summary(lerestiIImod10)
summary(lerestiIImod10.i)
summary(lerestiIImod10.ii)
summary(lerestiIImod11)
summary(lerestiIImod12)
summary(lerestiIImod12.i)
summary(lerestiIImod13)
summary(lerestiIImod14)
summary(lerestiIImod14.i)
summary(lerestiIImod14.ii)
summary(lerestiIImod15)
summary(lerestiIImod16)
summary(lerestiIImod17)
summary(lerestiIImod17.i)
summary(lerestiIImod18)
summary(lerestiIImod19)
summary(lerestiIImod20)
summary(lerestiIImod21)
summary(lerestiIImod22)
summary(lerestiIImod23)
summary(lerestiIImod24)
summary(lerestiIImod25)
summary(lerestiIImod26)
summary(lerestiIImod27)
summary(lerestiIImod28)
summary(lerestiIImod29)
summary(lerestiIImod30)
summary(lerestiIImod31)
summary(lerestiIImod32)
summary(lerestiIImod33)
summary(lerestiIImod34)
summary(lerestiIImod35)
summary(lerestiIImod36)
summary(lerestiIImod37)
summary(lerestiIImod38)
summary(lerestiIImod39)
summary(lerestiIImod40)
summary(lerestiIImod41)
summary(lerestiIImod42)
summary(lerestiIImod43)
summary(lerestiIImod44)
summary(lerestiIImod45)
summary(lerestiIImod46)
summary(lerestiIImod47)
summary(lerestiIImod48)
summary(lerestiIImod49)
summary(lerestiIImod50)
summary(lerestiIImod51)
summary(lerestiIImod52)
summary(lerestiIImod53)
```

AIC
```{r lerestiII AIC}
lerestiIImodsel <- model.sel(lerestiIImod1,lerestiIImod2,lerestiIImod3,lerestiIImod3.i,lerestiIImod4,lerestiIImod5,lerestiIImod6,lerestiIImod7,lerestiIImod8,lerestiIImod8.i,lerestiIImod9,lerestiIImod9.i,lerestiIImod9.ii,lerestiIImod10,lerestiIImod10.i,lerestiIImod10.ii,lerestiIImod11,lerestiIImod12,lerestiIImod12.i,lerestiIImod13,lerestiIImod14,lerestiIImod14.i,lerestiIImod14.ii,lerestiIImod15,lerestiIImod16,lerestiIImod17,lerestiIImod17.i,lerestiIImod18,lerestiIImod19,lerestiIImod20,lerestiIImod21, lerestiIImod22, lerestiIImod23, lerestiIImod24, lerestiIImod25, lerestiIImod26, lerestiIImod27, lerestiIImod28,lerestiIImod29,lerestiIImod30,lerestiIImod31,lerestiIImod32,lerestiIImod33,lerestiIImod34,lerestiIImod35,lerestiIImod36,lerestiIImod37,lerestiIImod38,lerestiIImod39,lerestiIImod40,lerestiIImod41,lerestiIImod42,lerestiIImod43,lerestiIImod44,lerestiIImod45,lerestiIImod46,lerestiIImod47,lerestiIImod48,lerestiIImod49,lerestiIImod50,lerestiIImod51,lerestiIImod52,lerestiIImod53)
lerestiIImodsel #lerestiIImod53 and 49
```
Subset (3): pre- and post- 1 year
```{r subset pre- and post-}
# Create a dataframe for pre 1 year
pre <- filtered_data[filtered_data$one_year == "pre", ]

# Create a dataframe for post 1 year
post <- filtered_data[filtered_data$one_year == "post", ]
```
tracks
```{r pre- and post- tracks}
#subset pre
pre_tracks <- pre %>%
  dplyr::select(x = longitude, y = latitude,
                t = t, id = Collar.ID)
#subset post
post_tracks <- post %>%
  dplyr::select(x = longitude, y = latitude,
                t = t, id = Collar.ID)
#remove NAs
post_tracks <-na.omit(post_tracks)
pre_tracks <-na.omit(pre_tracks)
#nest by id
nested_pre <- 
  pre_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_pre)
#nest by id
nested_post <- 
  post_tracks %>% 
  tidyr::nest(data = c(-id)) %>% 
  mutate(track = purrr::map(data, ~ mk_track(., x, y, t, crs = st_crs(32635))))

names(nested_post)
```
Step lengths
```{r pre- and post- step lengths}
step.lengths.pre <- unlist(map(nested_pre$track, step_lengths))
hist(step.lengths.pre, breaks = 20, main="Histogram of step lengths pre", xlab="Step lengths")
step.lengths.post <- unlist(map(nested_post$track, step_lengths))
hist(step.lengths.post, breaks = 20, main="Histogram of step lengths post", xlab="Step lengths")
```

```{r pre- and post- true steps}
true.steps.pre <- map(nested_pre$track, steps)
head(true.steps.pre[[1]])
true.steps.post <- map(nested_pre$track, steps)
head(true.steps.post[[1]])
```
Create random steps
Generating 5 random steps per used step.
.id="id" creates a new column with the id of the list so we can still separate data by animal.
```{r pre- and post- ranodm steps}
true.random.steps.pre <- map(true.steps.pre, random_steps, n=5)
all.steps.pre <- bind_rows(true.random.steps.pre, .id="id")
all.steps.pre
true.random.steps.post <- map(true.steps.post, random_steps, n=5)
all.steps.post <- bind_rows(true.random.steps.post, .id="id")
all.steps.post
```
distribution of turning angles for used steps only
```{r pre- and post- turning angles}
with(all.steps.pre, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles pre", xlab="turning angle"))
with(all.steps.post, hist(ta_[case_==T], breaks=20, main = "Histogram of turning angles post", xlab="turning angle"))
```

```{r pre- and post- clean up}
steps.sp.pre <- all.steps.pre
steps.sp.post <- all.steps.post
#remove NA
steps.sp.pre <- na.omit(steps.sp.pre)
steps.sp.post <- na.omit(steps.sp.post)
coordinates(steps.sp.pre) <- ~x2_+y2_
proj4string(steps.sp.pre) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
coordinates(steps.sp.post) <- ~x2_+y2_
proj4string(steps.sp.post) <- CRS("+proj=utm +zone=35 +datum=WGS84 +units=m +no_defs")
```
Extract habitat covariate data
pre
```{r pre- covraiate extraction}
pre_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.pre)
pre_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.pre)
pre_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.pre)
pre_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.pre)
pre_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.pre)
pre_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.pre)
pre_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.pre)
pre_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.pre)
pre_elevation <- raster::extract(elevation_scaled, steps.sp.pre)
pre_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.pre)
pre_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.pre)
pre_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.pre)
pre_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.pre)
pre_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.pre)
pre_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.pre)
pre_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.pre)
pre_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.pre)

covariates_pre <- cbind(pre_distance_to_roads,pre_distance_to_forest_edge,pre_distance_to_riparian,pre_distance_to_release_sites,pre_NDVI_aug20,pre_NDVI_mar21,pre_NDWI_aug20,pre_NDWI_mar21,pre_elevation,pre_TRI_50,pre_broad_2000,pre_mixed_2000,pre_ngrass_2000,pre_hm_grass_2000,pre_transitional_2000,pre_aspect_2000,pre_slope_500)
```
post
```{r post covariate extraction}
post_distance_to_roads <- raster::extract(distance_to_roads_scaled, steps.sp.post)
post_distance_to_forest_edge <- raster::extract(distance_to_forest_edge_scaled, steps.sp.post)
post_distance_to_riparian <- raster::extract(distance_to_riparian_scaled, steps.sp.post)
post_distance_to_release_sites <- raster::extract(distance_to_release_sites_scaled, steps.sp.post)
post_NDVI_aug20 <- raster::extract(NDVI_aug_2020_scaled, steps.sp.post)
post_NDVI_mar21 <- raster::extract(NDVI_march_2021_scaled, steps.sp.post)
post_NDWI_aug20 <- raster::extract(NDWI_aug_2020_scaled, steps.sp.post)
post_NDWI_mar21 <- raster::extract(NDWI_march_2021_scaled, steps.sp.post)
post_elevation <- raster::extract(elevation_scaled, steps.sp.post)
post_TRI_50 <- raster::extract(TRI_50_scaled, steps.sp.post)
post_broad_2000 <- raster::extract(MWA_broad_2000_scaled, steps.sp.post)
post_mixed_2000 <- raster::extract(MWA_mixed_2000_scaled, steps.sp.post)
post_ngrass_2000 <- raster::extract(MWA_ngrass_2000_scaled, steps.sp.post)
post_hm_grass_2000 <- raster::extract(MWA_hmgrass_2000_scaled, steps.sp.post)
post_transitional_2000 <- raster::extract(MWA_transitional_2000_scaled, steps.sp.post)
post_aspect_2000 <- raster::extract(MWA_aspect_2000_scaled, steps.sp.post)
post_slope_500 <- raster::extract(MWA_slope_500_scaled, steps.sp.post)

covariates_post <- cbind(post_distance_to_roads,post_distance_to_forest_edge,post_distance_to_riparian,post_distance_to_release_sites,post_NDVI_aug20,post_NDVI_mar21,post_NDWI_aug20,post_NDWI_mar21,post_elevation,post_TRI_50,post_broad_2000,post_mixed_2000,post_ngrass_2000,post_hm_grass_2000,post_transitional_2000,post_aspect_2000,post_slope_500)
```
add the covariate data to our SpatialPointsDataFrame of used and random steps
```{r pre- spatial df}
steps.sp.pre$pre_distance_to_roads <- covariates_pre[,1]
steps.sp.pre$pre_distance_to_forest_edge <- covariates_pre[,2]
steps.sp.pre$pre_distance_to_riparian <- covariates_pre[,3]
steps.sp.pre$pre_distance_to_release_sites <- covariates_pre[,4]
steps.sp.pre$pre_NDVI_aug20 <- covariates_pre[,5]
steps.sp.pre$pre_NDVI_mar21 <- covariates_pre[,6]
steps.sp.pre$pre_NDWI_aug20 <- covariates_pre[,7]
steps.sp.pre$pre_NDWI_mar21 <- covariates_pre[,8]
steps.sp.pre$pre_elevation <- covariates_pre[,9]
steps.sp.pre$pre_TRI_50 <- covariates_pre[,10]
steps.sp.pre$pre_broad_2000 <- covariates_pre[,11]
steps.sp.pre$pre_mixed_2000 <- covariates_pre[,12]
steps.sp.pre$pre_ngrass_2000 <- covariates_pre[,13]
steps.sp.pre$pre_hm_grass_2000 <- covariates_pre[,14]
steps.sp.pre$pre_transitional_2000 <- covariates_pre[,15]
steps.sp.pre$pre_aspect_2000 <- covariates_pre[,16]
steps.sp.pre$pre_slope_500 <- covariates_pre[,17]

head(steps.sp.pre)
```
post
```{r post- spatial df}
steps.sp.post$post_distance_to_roads <- covariates_post[,1]
steps.sp.post$post_distance_to_forest_edge <- covariates_post[,2]
steps.sp.post$post_distance_to_riparian <- covariates_post[,3]
steps.sp.post$post_distance_to_release_sites <- covariates_post[,4]
steps.sp.post$post_NDVI_aug20 <- covariates_post[,5]
steps.sp.post$post_NDVI_mar21 <- covariates_post[,6]
steps.sp.post$post_NDWI_aug20 <- covariates_post[,7]
steps.sp.post$post_NDWI_mar21 <- covariates_post[,8]
steps.sp.post$post_elevation <- covariates_post[,9]
steps.sp.post$post_TRI_50 <- covariates_post[,10]
steps.sp.post$post_broad_2000 <- covariates_post[,11]
steps.sp.post$post_mixed_2000 <- covariates_post[,12]
steps.sp.post$post_ngrass_2000 <- covariates_post[,13]
steps.sp.post$post_hm_grass_2000 <- covariates_post[,14]
steps.sp.post$post_transitional_2000 <- covariates_post[,15]
steps.sp.post$post_aspect_2000 <- covariates_post[,16]
steps.sp.post$post_slope_500 <- covariates_post[,17]

head(steps.sp.post)
```

```{r}
#Export
write.csv(steps.sp.pre, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.pre.csv", row.names = FALSE)
write.csv(steps.sp.post, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/steps.sp.post.csv", row.names = FALSE)
```

Models
pre
```{r pre models}
#distance to riparian and distance to forest
premod1 <- survival::clogit(case_ ~ pre_distance_to_riparian + pre_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
coef(premod1)
#Distance to roads + distance to forests
premod2 <- survival::clogit(case_ ~pre_distance_to_roads + pre_distance_to_forest_edge + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#Distance to rip + distance to forests + distance to roads
premod3 <- survival::clogit(case_ ~pre_distance_to_riparian + pre_distance_to_roads + pre_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
##Distance to rip and distance to forests interaction with  distance to roads
premod3.i <- survival::clogit(case_ ~pre_distance_to_riparian*pre_distance_to_forest_edge + pre_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#Distance to rip + distance to forests + distance to release sites 
premod4 <- survival::clogit(case_ ~ pre_distance_to_riparian + pre_distance_to_release_sites + pre_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI + NDWI pre
premod5 <- survival::clogit(case_ ~pre_NDVI_aug20 + pre_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI + NDWI march
premod6 <- survival::clogit(case_ ~ pre_NDVI_mar21 + pre_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI + elevation pre
premod7 <- survival::clogit(case_ ~ pre_NDVI_aug20 + pre_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI elevation interaction
premod7.i <- survival::clogit(case_ ~ pre_NDVI_aug20*pre_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI and elevation pre
premod8 <- survival::clogit(case_ ~ pre_NDVI_mar21 + pre_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI and elevation interaction pre
premod8.i <- survival::clogit(case_ ~ pre_NDVI_mar21*pre_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI + broad + mixed pre
premod9 <- survival::clogit(case_ ~ pre_NDVI_aug20 + pre_broad_2000 + pre_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI and broad interaction with mixed pre
premod9.i<- survival::clogit(case_ ~ pre_NDVI_aug20*pre_broad_2000 + pre_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI and mixed interaction with broad pre
premod9.ii<- survival::clogit(case_ ~ pre_NDVI_aug20*pre_mixed_2000 + pre_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI + broad + mixed pre
premod10 <- survival::clogit(case_ ~ pre_NDVI_mar21 + pre_broad_2000 + pre_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI and broad interaction with mixed pre
premod10.i<- survival::clogit(case_ ~ pre_NDVI_mar21*pre_broad_2000 + pre_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#NDVI and mixed interaction with broad pre
premod10.ii<- survival::clogit(case_ ~ pre_NDVI_mar21*pre_mixed_2000 + pre_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#broad and mixed
premod11 <- survival::clogit(case_ ~ pre_broad_2000 + pre_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#Natural grassland +hm grassland
premod12 <- survival::clogit(case_ ~ pre_ngrass_2000 + pre_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#natural grassland and human managed grassland interaction
premod12.i <- survival::clogit(case_ ~ pre_ngrass_2000*pre_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#Mixed forest+ transition habitat
premod13 <- survival::clogit(case_ ~ pre_mixed_2000 + pre_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#Broad + mixed + natgrass + hmgrass + transitional
premod14 <- survival::clogit(case_ ~ pre_broad_2000 + pre_mixed_2000 + pre_ngrass_2000 + pre_hm_grass_2000 + pre_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#broad and mixed interaction with natural grasslands and human managed grassland
premod14.i <- survival::clogit(case_ ~ pre_broad_2000*pre_mixed_2000 + pre_ngrass_2000 + pre_hm_grass_2000 + pre_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#natural grasslands and human managed grasslands interaction with broad and mixed
premod14.ii <- survival::clogit(case_ ~ pre_broad_2000 + pre_mixed_2000 + pre_ngrass_2000*pre_hm_grass_2000 + pre_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
premod15 <- survival::clogit(case_ ~ pre_broad_2000 + pre_mixed_2000 + pre_ngrass_2000 + pre_hm_grass_2000 + pre_transitional_2000 + pre_distance_to_riparian + pre_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#Broad + mixed + distance to roads
premod16 <- survival::clogit(case_ ~ pre_broad_2000 + pre_mixed_2000 + pre_distance_to_roads + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#TRI + slope + elevation + aspect
premod17 <- survival::clogit(case_ ~ pre_TRI_50 + pre_slope_500 + pre_elevation + pre_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#TRI and elevation interaction with slope + aspect
premod17.i <- survival::clogit(case_ ~ pre_TRI_50*pre_elevation + pre_slope_500 + pre_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#TRI + slope + elevation + aspect + ndvi + ndwi
premod18 <- survival::clogit(case_ ~ pre_TRI_50 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_aug20 + pre_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#TRI + slope + elevation + aspect + NDVI pre + NDWI pre
premod19 <- survival::clogit(case_ ~ pre_TRI_50 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#TRI + slope + elevation + aspect +forest mixed + forest broad
premod20 <- survival::clogit(case_ ~ pre_TRI_50 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_mixed_2000 + pre_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#forest edge and roads
premod21 <- survival::clogit(case_ ~  pre_distance_to_forest_edge*pre_distance_to_roads + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
summary(premod21)
#forest edge and broad
premod22 <- survival::clogit(case_ ~ pre_distance_to_forest_edge + pre_broad_2000 + pre_distance_to_forest_edge*pre_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#riparian zones and elevation
premod23 <- survival::clogit(case_ ~ pre_distance_to_riparian + pre_elevation + pre_distance_to_riparian* pre_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#broadleaf forest and elevation (with TRI and NDVI)
premod24 <- survival::clogit(case_ ~ pre_broad_2000*pre_elevation + pre_TRI_50 + pre_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
premod24.1 <- survival::clogit(case_ ~ pre_broad_2000*pre_elevation + pre_TRI_50 + pre_NDVI_aug20 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#natural grasslands and distance to forest edge (with NDVI and elevation)
premod25 <- survival::clogit(case_ ~ pre_ngrass_2000*pre_distance_to_forest_edge + pre_NDVI_mar21 + pre_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#transitional and distance to forest edge (with elevation and aspect and TRI)
premod26 <- survival::clogit(case_ ~ pre_transitional_2000*pre_distance_to_forest_edge + pre_elevation + pre_aspect_2000 + pre_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#transitional and mixed forest (with broadleaf and elevation)
premod27 <- survival::clogit(case_ ~ pre_transitional_2000*pre_mixed_2000 + pre_elevation + pre_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#transitional and broadleaf (with mixed and elevation)
premod28 <- survival::clogit(case_ ~ pre_transitional_2000*pre_broad_2000 + pre_elevation + pre_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to roads and broadleaf (with NDVI and elevation)
premod29 <- survival::clogit(case_ ~ pre_distance_to_roads*pre_broad_2000 + pre_elevation + pre_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to roads and mixed (with NDVI and elevation)
premod30 <- survival::clogit(case_ ~ pre_distance_to_roads*pre_mixed_2000 + pre_elevation + pre_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
premod31 <- survival::clogit(case_ ~ pre_distance_to_roads*pre_ngrass_2000 + pre_elevation + pre_NDVI_mar21 + pre_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
premod32 <- survival::clogit(case_ ~ pre_distance_to_roads*pre_transitional_2000 + pre_elevation + pre_NDVI_mar21 + pre_TRI_50 + pre_ngrass_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
premod33 <- survival::clogit(case_ ~ pre_distance_to_release_sites*pre_ngrass_2000 + pre_broad_2000 + pre_NDVI_mar21 + pre_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
premod34 <- survival::clogit(case_ ~ pre_distance_to_release_sites*pre_broad_2000 + pre_ngrass_2000 + pre_NDVI_mar21 + pre_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to release sites and mixed (with grasslands, broad and NDVI)
premod35 <- survival::clogit(case_ ~ pre_distance_to_release_sites*pre_mixed_2000 + pre_ngrass_2000 + pre_NDVI_mar21 + pre_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and broadleaf (with premod19-slope, elevation, aspect, NDVI and NDWI)
premod36 <- survival::clogit(case_ ~ pre_TRI_50*pre_broad_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and natgrasslands (with premod19-slope, elevation, aspect, NDVI and NDWI)
premod37 <- survival::clogit(case_ ~ pre_TRI_50*pre_ngrass_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and mixed (with premod19-slope, elevation, aspect, NDVI and NDWI)
premod38 <- survival::clogit(case_ ~ pre_TRI_50*pre_mixed_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and transitional habitat (with premod19-slope, elevation, aspect, NDVI and NDWI)
premod39 <- survival::clogit(case_ ~ pre_TRI_50*pre_transitional_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to forest edge and NDVI (with elevation, slope and TRI)
premod40 <- survival::clogit(case_ ~ pre_distance_to_forest_edge*pre_NDVI_mar21 + pre_slope_500 + pre_elevation + pre_TRI_50 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to release sites and TRI (with aspect, elevation and slope)
premod41 <- survival::clogit(case_ ~ pre_distance_to_release_sites*pre_TRI_50 + pre_slope_500 + pre_elevation + pre_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to release sites and elevation (with aspect, TRI and slope)
premod42 <- survival::clogit(case_ ~ pre_distance_to_release_sites*pre_elevation + pre_slope_500 + pre_TRI_50 + pre_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
premod43 <- survival::clogit(case_ ~ pre_distance_to_forest_edge*pre_broad_2000 + pre_mixed_2000 + pre_NDVI_mar21 + pre_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
premod44 <- survival::clogit(case_ ~ pre_distance_to_forest_edge*pre_mixed_2000 + pre_broad_2000 + pre_NDVI_mar21 + pre_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
#Elevation and TRI (with ndvi, slope and aspect)
premod45 <- survival::clogit(case_ ~ pre_elevation*pre_TRI_50+ pre_broad_2000 + pre_NDVI_mar21 + pre_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
premod46 <- survival::clogit(case_ ~ pre_TRI_50*pre_broad_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + pre_distance_to_forest_edge + pre_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
premod47 <- survival::clogit(case_ ~ pre_TRI_50*pre_ngrass_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + pre_distance_to_forest_edge + pre_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
premod48 <- survival::clogit(case_ ~ pre_TRI_50*pre_mixed_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + pre_distance_to_forest_edge + pre_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
premod49 <- survival::clogit(case_ ~ pre_TRI_50*pre_transitional_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21+ pre_distance_to_forest_edge + pre_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
premod50 <- survival::clogit(case_ ~ pre_TRI_50*pre_broad_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + pre_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
premod51 <- survival::clogit(case_ ~ pre_TRI_50*pre_ngrass_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + pre_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
premod52 <- survival::clogit(case_ ~ pre_TRI_50*pre_mixed_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21 + pre_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
premod53 <- survival::clogit(case_ ~ pre_TRI_50*pre_transitional_2000 + pre_slope_500 + pre_elevation + pre_aspect_2000 + pre_NDVI_mar21 + pre_NDWI_mar21+ pre_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.pre)
summary(premod1)
summary(premod2)
summary(premod3)
summary(premod3.i)
summary(premod4)
summary(premod5)
summary(premod6)
summary(premod7)
summary(premod8)
summary(premod8.i)
summary(premod9)
summary(premod9.i)
summary(premod9.ii)
summary(premod10)
summary(premod10.i)
summary(premod10.ii)
summary(premod11)
summary(premod12)
summary(premod12.i)
summary(premod13)
summary(premod14)
summary(premod14.i)
summary(premod14.ii)
summary(premod15)
summary(premod16)
summary(premod17)
summary(premod17.i)
summary(premod18)
summary(premod19)
summary(premod20)
summary(premod21)
summary(premod22)
summary(premod23)
summary(premod24)
summary(premod25)
summary(premod26)
summary(premod27)
summary(premod28)
summary(premod29)
summary(premod30)
summary(premod31)
summary(premod32)
summary(premod33)
summary(premod34)
summary(premod35)
summary(premod36)
summary(premod37)
summary(premod38)
summary(premod39)
summary(premod40)
summary(premod41)
summary(premod42)
summary(premod43)
summary(premod44)
summary(premod45)
summary(premod46)
summary(premod47)
summary(premod48)
summary(premod49)
summary(premod50)
summary(premod51)
summary(premod52)
summary(premod53)
```

AIC
```{r pre AIC}
premodsel <- model.sel(premod1,premod2,premod3,premod3.i,premod4,premod5,premod6,premod7,premod8,premod8.i,premod9,premod9.i,premod9.ii,premod10,premod10.i,premod10.ii,premod11,premod12,premod12.i,premod13,premod14,premod14.i,premod14.ii,premod15,premod16,premod17,premod17.i,premod18,premod19,premod20,premod21, premod22, premod23, premod24, premod25, premod26, premod27, premod28,premod29,premod30,premod31,premod32,premod33,premod34,premod35,premod36,premod37,premod38,premod39,premod40,premod41,premod42,premod43,premod44,premod45,premod46,premod47,premod48,premod49,premod50,premod51,premod52,premod53)
premodsel #premod48 and 52
```
Models
post
```{r post models}
#distance to riparian and distance to forest
postmod1 <- survival::clogit(case_ ~ post_distance_to_riparian + post_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
coef(postmod1)
#Distance to roads + distance to forests
postmod2 <- survival::clogit(case_ ~post_distance_to_roads + post_distance_to_forest_edge + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#Distance to rip + distance to forests + distance to roads
postmod3 <- survival::clogit(case_ ~post_distance_to_riparian + post_distance_to_roads + post_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
##Distance to rip and distance to forests interaction with  distance to roads
postmod3.i <- survival::clogit(case_ ~post_distance_to_riparian*post_distance_to_forest_edge + post_distance_to_forest_edge + cluster(id) +scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#Distance to rip + distance to forests + distance to release sites 
postmod4 <- survival::clogit(case_ ~ post_distance_to_riparian + post_distance_to_release_sites + post_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI + NDWI post
postmod5 <- survival::clogit(case_ ~post_NDVI_aug20 + post_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI + NDWI march
postmod6 <- survival::clogit(case_ ~ post_NDVI_mar21 + post_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI + elevation post
postmod7 <- survival::clogit(case_ ~ post_NDVI_aug20 + post_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI elevation interaction
postmod7.i <- survival::clogit(case_ ~ post_NDVI_aug20*post_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI and elevation post
postmod8 <- survival::clogit(case_ ~ post_NDVI_mar21 + post_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI and elevation interaction post
postmod8.i <- survival::clogit(case_ ~ post_NDVI_mar21*post_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI + broad + mixed post
postmod9 <- survival::clogit(case_ ~ post_NDVI_aug20 + post_broad_2000 + post_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI and broad interaction with mixed post
postmod9.i<- survival::clogit(case_ ~ post_NDVI_aug20*post_broad_2000 + post_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI and mixed interaction with broad post
postmod9.ii<- survival::clogit(case_ ~ post_NDVI_aug20*post_mixed_2000 + post_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI + broad + mixed post
postmod10 <- survival::clogit(case_ ~ post_NDVI_mar21 + post_broad_2000 + post_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI and broad interaction with mixed post
postmod10.i<- survival::clogit(case_ ~ post_NDVI_mar21*post_broad_2000 + post_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#NDVI and mixed interaction with broad post
postmod10.ii<- survival::clogit(case_ ~ post_NDVI_mar21*post_mixed_2000 + post_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#broad and mixed
postmod11 <- survival::clogit(case_ ~ post_broad_2000 + post_mixed_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#Natural grassland +hm grassland
postmod12 <- survival::clogit(case_ ~ post_ngrass_2000 + post_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#natural grassland and human managed grassland interaction
postmod12.i <- survival::clogit(case_ ~ post_ngrass_2000*post_hm_grass_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#Mixed forest+ transition habitat
postmod13 <- survival::clogit(case_ ~ post_mixed_2000 + post_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#Broad + mixed + natgrass + hmgrass + transitional
postmod14 <- survival::clogit(case_ ~ post_broad_2000 + post_mixed_2000 + post_ngrass_2000 + post_hm_grass_2000 + post_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#broad and mixed interaction with natural grasslands and human managed grassland
postmod14.i <- survival::clogit(case_ ~ post_broad_2000*post_mixed_2000 + post_ngrass_2000 + post_hm_grass_2000 + post_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#natural grasslands and human managed grasslands interaction with broad and mixed
postmod14.ii <- survival::clogit(case_ ~ post_broad_2000 + post_mixed_2000 + post_ngrass_2000*post_hm_grass_2000 + post_transitional_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#Broad + mixed + natgrass + hmgrass + transitional + dist to rip + dist to forest
postmod15 <- survival::clogit(case_ ~ post_broad_2000 + post_mixed_2000 + post_ngrass_2000 + post_hm_grass_2000 + post_transitional_2000 + post_distance_to_riparian + post_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#Broad + mixed + distance to roads
postmod16 <- survival::clogit(case_ ~ post_broad_2000 + post_mixed_2000 + post_distance_to_roads + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#TRI + slope + elevation + aspect
postmod17 <- survival::clogit(case_ ~ post_TRI_50 + post_slope_500 + post_elevation + post_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#TRI and elevation interaction with slope + aspect
postmod17.i <- survival::clogit(case_ ~ post_TRI_50*post_elevation + post_slope_500 + post_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#TRI + slope + elevation + aspect + ndvi + ndwi
postmod18 <- survival::clogit(case_ ~ post_TRI_50 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_aug20 + post_NDWI_aug20 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#TRI + slope + elevation + aspect + NDVI post + NDWI post
postmod19 <- survival::clogit(case_ ~ post_TRI_50 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#TRI + slope + elevation + aspect +forest mixed + forest broad
postmod20 <- survival::clogit(case_ ~ post_TRI_50 + post_slope_500 + post_elevation + post_aspect_2000 + post_mixed_2000 + post_broad_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#forest edge and roads
postmod21 <- survival::clogit(case_ ~  post_distance_to_forest_edge*post_distance_to_roads + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
summary(postmod21)
#forest edge and broad
postmod22 <- survival::clogit(case_ ~ post_distance_to_forest_edge + post_broad_2000 + post_distance_to_forest_edge*post_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#riparian zones and elevation
postmod23 <- survival::clogit(case_ ~ post_distance_to_riparian + post_elevation + post_distance_to_riparian* post_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#broadleaf forest and elevation (with TRI and NDVI)
postmod24 <- survival::clogit(case_ ~ post_broad_2000*post_elevation + post_TRI_50 + post_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
postmod24.1 <- survival::clogit(case_ ~ post_broad_2000*post_elevation + post_TRI_50 + post_NDVI_aug20 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#natural grasslands and distance to forest edge (with NDVI and elevation)
postmod25 <- survival::clogit(case_ ~ post_ngrass_2000*post_distance_to_forest_edge + post_NDVI_mar21 + post_elevation + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#transitional and distance to forest edge (with elevation and aspect and TRI)
postmod26 <- survival::clogit(case_ ~ post_transitional_2000*post_distance_to_forest_edge + post_elevation + post_aspect_2000 + post_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#transitional and mixed forest (with broadleaf and elevation)
postmod27 <- survival::clogit(case_ ~ post_transitional_2000*post_mixed_2000 + post_elevation + post_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#transitional and broadleaf (with mixed and elevation)
postmod28 <- survival::clogit(case_ ~ post_transitional_2000*post_broad_2000 + post_elevation + post_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to roads and broadleaf (with NDVI and elevation)
postmod29 <- survival::clogit(case_ ~ post_distance_to_roads*post_broad_2000 + post_elevation + post_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to roads and mixed (with NDVI and elevation)
postmod30 <- survival::clogit(case_ ~ post_distance_to_roads*post_mixed_2000 + post_elevation + post_NDVI_mar21 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to roads and natural grasslands (with NDVI, elevation and TRI)
postmod31 <- survival::clogit(case_ ~ post_distance_to_roads*post_ngrass_2000 + post_elevation + post_NDVI_mar21 + post_TRI_50 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to roads and transitional (with NDVI, elevation, natural grasslands and TRI)
postmod32 <- survival::clogit(case_ ~ post_distance_to_roads*post_transitional_2000 + post_elevation + post_NDVI_mar21 + post_TRI_50 + post_ngrass_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to release sites and natural grasslands (with broadleaf, mixed and NDVI)
postmod33 <- survival::clogit(case_ ~ post_distance_to_release_sites*post_ngrass_2000 + post_broad_2000 + post_NDVI_mar21 + post_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to release sites and broadleaf (with grasslands,mixed and NDVI)
postmod34 <- survival::clogit(case_ ~ post_distance_to_release_sites*post_broad_2000 + post_ngrass_2000 + post_NDVI_mar21 + post_mixed_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to release sites and mixed (with grasslands, broad and NDVI)
postmod35 <- survival::clogit(case_ ~ post_distance_to_release_sites*post_mixed_2000 + post_ngrass_2000 + post_NDVI_mar21 + post_broad_2000 + cluster(id) + scale(sl_)+ strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and broadleaf (with postmod19-slope, elevation, aspect, NDVI and NDWI)
postmod36 <- survival::clogit(case_ ~ post_TRI_50*post_broad_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and natgrasslands (with postmod19-slope, elevation, aspect, NDVI and NDWI)
postmod37 <- survival::clogit(case_ ~ post_TRI_50*post_ngrass_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and mixed (with postmod19-slope, elevation, aspect, NDVI and NDWI)
postmod38 <- survival::clogit(case_ ~ post_TRI_50*post_mixed_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and transitional habitat (with postmod19-slope, elevation, aspect, NDVI and NDWI)
postmod39 <- survival::clogit(case_ ~ post_TRI_50*post_transitional_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to forest edge and NDVI (with elevation, slope and TRI)
postmod40 <- survival::clogit(case_ ~ post_distance_to_forest_edge*post_NDVI_mar21 + post_slope_500 + post_elevation + post_TRI_50 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to release sites and TRI (with aspect, elevation and slope)
postmod41 <- survival::clogit(case_ ~ post_distance_to_release_sites*post_TRI_50 + post_slope_500 + post_elevation + post_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to release sites and elevation (with aspect, TRI and slope)
postmod42 <- survival::clogit(case_ ~ post_distance_to_release_sites*post_elevation + post_slope_500 + post_TRI_50 + post_aspect_2000 + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to forest edge and broadleaf (with mixed, ndvi and elevation)
postmod43 <- survival::clogit(case_ ~ post_distance_to_forest_edge*post_broad_2000 + post_mixed_2000 + post_NDVI_mar21 + post_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#distance to forest edge and mixed (with broadleaf, ndvi and elevation)
postmod44 <- survival::clogit(case_ ~ post_distance_to_forest_edge*post_mixed_2000 + post_broad_2000 + post_NDVI_mar21 + post_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
#Elevation and TRI (with ndvi, slope and aspect)
postmod45 <- survival::clogit(case_ ~ post_elevation*post_TRI_50+ post_broad_2000 + post_NDVI_mar21 + post_elevation + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
postmod46 <- survival::clogit(case_ ~ post_TRI_50*post_broad_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + post_distance_to_forest_edge + post_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
postmod47 <- survival::clogit(case_ ~ post_TRI_50*post_ngrass_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + post_distance_to_forest_edge + post_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and mixed (with slope, elevation, aspect, NDVI, NDWI, distance to forest edge and distance to release sites)
postmod48 <- survival::clogit(case_ ~ post_TRI_50*post_mixed_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + post_distance_to_forest_edge + post_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI, distance to forest edge and distance to release sites)
postmod49 <- survival::clogit(case_ ~ post_TRI_50*post_transitional_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21+ post_distance_to_forest_edge + post_distance_to_release_sites + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and broad (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
postmod50 <- survival::clogit(case_ ~ post_TRI_50*post_broad_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + post_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and natgrasslands (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
postmod51 <- survival::clogit(case_ ~ post_TRI_50*post_ngrass_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + post_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and mixed (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
postmod52 <- survival::clogit(case_ ~ post_TRI_50*post_mixed_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21 + post_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
# TRI and transitional habitat (with slope, elevation, aspect, NDVI,NDWI and distance to forest edge)
postmod53 <- survival::clogit(case_ ~ post_TRI_50*post_transitional_2000 + post_slope_500 + post_elevation + post_aspect_2000 + post_NDVI_mar21 + post_NDWI_mar21+ post_distance_to_forest_edge + cluster(id) + scale(sl_) + strata(step_id_), method = 'approximate', data = steps.sp.post)
summary(postmod1)
summary(postmod2)
summary(postmod3)
summary(postmod3.i)
summary(postmod4)
summary(postmod5)
summary(postmod6)
summary(postmod7)
summary(postmod8)
summary(postmod8.i)
summary(postmod9)
summary(postmod9.i)
summary(postmod9.ii)
summary(postmod10)
summary(postmod10.i)
summary(postmod10.ii)
summary(postmod11)
summary(postmod12)
summary(postmod12.i)
summary(postmod13)
summary(postmod14)
summary(postmod14.i)
summary(postmod14.ii)
summary(postmod15)
summary(postmod16)
summary(postmod17)
summary(postmod17.i)
summary(postmod18)
summary(postmod19)
summary(postmod20)
summary(postmod21)
summary(postmod22)
summary(postmod23)
summary(postmod24)
summary(postmod25)
summary(postmod26)
summary(postmod27)
summary(postmod28)
summary(postmod29)
summary(postmod30)
summary(postmod31)
summary(postmod32)
summary(postmod33)
summary(postmod34)
summary(postmod35)
summary(postmod36)
summary(postmod37)
summary(postmod38)
summary(postmod39)
summary(postmod40)
summary(postmod41)
summary(postmod42)
summary(postmod43)
summary(postmod44)
summary(postmod45)
summary(postmod46)
summary(postmod47)
summary(postmod48)
summary(postmod49)
summary(postmod50)
summary(postmod51)
summary(postmod52)
summary(postmod53)
summary(premod48)
summary(postmod48)
```

AIC
```{r post AIC}
postmodsel <- model.sel(postmod1,postmod2,postmod3,postmod3.i,postmod4,postmod5,postmod6,postmod7,postmod8,postmod8.i,postmod9,postmod9.i,postmod9.ii,postmod10,postmod10.i,postmod10.ii,postmod11,postmod12,postmod12.i,postmod13,postmod14,postmod14.i,postmod14.ii,postmod15,postmod16,postmod17,postmod17.i,postmod18,postmod19,postmod20,postmod21, postmod22, postmod23, postmod24, postmod25, postmod26, postmod27, postmod28,postmod29,postmod30,postmod31,postmod32,postmod33,postmod34,postmod35,postmod36,postmod37,postmod38,postmod39,postmod40,postmod41,postmod42,postmod43,postmod44,postmod45,postmod46,postmod47,postmod48,postmod49,postmod50,postmod51,postmod52,postmod53)
postmodsel #postmod48 and 52
```
Plots
(top 5 moldels based on AIC for all data and the subsets)
```{r plots}
library(survival)
library(sjPlot)
#All data
plot_model(mod48, title="All data SSF48 Coefficients (top 1)")
plot_model(mod49, title="All data SSF49 Coefficients (top 2)")
plot_model(mod38, title="All data SSF38 Coefficients (top 3)")
plot_model(mod39, title="All data SSF39 Coefficients (top 4)")
plot_model(mod50, title="All data SSF50 Coefficients (top 5)")
#Winter subset
plot_model(wintermod48, title="Winter SSF48 Coefficients (top 1)")
plot_model(wintermod52, title="Winter SSF52 Coefficients (top 2)")
plot_model(wintermod38, title="Winter SSF38 Coefficients (top 3)")
plot_model(wintermod47, title="Winter SSF47 Coefficients (top 4)")
plot_model(wintermod51, title="Winter SSF51 Coefficients (top 5)")
#Summer subset
plot_model(summermod48, title="Summer SSF48 Coefficients (top 1)")
plot_model(summermod52, title="Summer SSF52 Coefficients (top 2)")
plot_model(summermod38, title="Summer SSF38 Coefficients (top 3)")
plot_model(summermod46, title="Summer SSF46 Coefficients (top 4)")
plot_model(summermod47, title="Summer SSF47 Coefficients (top 5)")
#Bunea subset
plot_model(buneamod50, title="Bunea SSF50 Coefficients (top 1)")
plot_model(buneamod46, title="Bunea SSF46 Coefficients (top 2)")
plot_model(buneamod36, title="Bunea SSF36 Coefficients (top 3)")
plot_model(buneamod48, title="Bunea SSF48 Coefficients (top 4)")
plot_model(buneamod52, title="Bunea SSF52 Coefficients (top 5)")
#BuneaI
plot_model(buneaImod51, title="Bunea I SSF50 Coefficients (top 1)")
plot_model(buneaImod47, title="Bunea I SSF46 Coefficients (top 2)")
plot_model(buneaImod46, title="Bunea I SSF40 Coefficients (top 3)")
plot_model(buneaImod50, title="Bunea I SSF51 Coefficients (top 4)")
plot_model(buneaImod37, title="Bunea I SSF53 Coefficients (top 5)")
#BuneaII
plot_model(buneaIImod40, title="Bunea II SSF40 Coefficients (top 1)")
plot_model(buneaIImod50, title="Bunea II SSF50 Coefficients (top 2)")
plot_model(buneaIImod46, title="Bunea II SSF46 Coefficients (top 3)")
plot_model(buneaIImod51, title="Bunea II SSF51 Coefficients (top 4)")
plot_model(buneaIImod47, title="Bunea II SSF47 Coefficients (top 5)")
#Leresti subset
plot_model(lerestimod50, title="Leresti SSF50 Coefficients (top 1)")
plot_model(lerestimod46, title="Leresti SSF46 Coefficients (top 2)")
plot_model(lerestimod36, title="Leresti SSF36 Coefficients (top 3)")
plot_model(lerestimod48, title="Leresti SSF48 Coefficients (top 4)")
plot_model(lerestimod52, title="Leresti SSF52 Coefficients (top 5)")
#Leresti I
plot_model(lerestiImod48, title="Leresti I SSF48 Coefficients (top 1)")
plot_model(lerestiImod52, title="Leresti I SSF52 Coefficients (top 2)")
plot_model(lerestiImod53, title="Leresti I SSF53 Coefficients (top 3)")
plot_model(lerestiImod49, title="Leresti I SSF49 Coefficients (top 4)")
plot_model(lerestiImod38, title="Leresti I SSF38 Coefficients (top 5)")
#Leresti II
plot_model(lerestiIImod53, title="Leresti II SSF48 Coefficients (top 1)")
plot_model(lerestiIImod49, title="Leresti II SSF52 Coefficients (top 2)")
plot_model(lerestiIImod48, title="Leresti II SSF53 Coefficients (top 3)")
plot_model(lerestiIImod52, title="Leresti II SSF49 Coefficients (top 4)")
plot_model(lerestiIImod39, title="Leresti II SSF38 Coefficients (top 5)")
#pre 1 year subset
plot_model(premod48, title="Pre 1 year SSF48 Coefficients (top 1)")
plot_model(premod52, title="Pre 1 year SSF52 Coefficients (top 2)")
plot_model(premod38, title="Pre 1 year SSF38 Coefficients (top 3)")
plot_model(premod49, title="Pre 1 year SSF49 Coefficients (top 4)")
plot_model(premod47, title="Pre 1 year SSF47 Coefficients (top 5)")
#post 1 year subset
plot_model(postmod48, title="Post 1 year SSF48 Coefficients (top 1)")
plot_model(postmod52, title="Post 1 year SSF52 Coefficients (top 2)")
plot_model(postmod38, title="Post 1 year SSF38 Coefficients (top 3)")
plot_model(postmod49, title="Post 1 year SSF49 Coefficients (top 4)")
plot_model(postmod47, title="Post 1 year SSF47 Coefficients (top 5)")
#Grid plot with top plot for each subset
plot_model(mod48, title="All data SSF48 Coefficients (top 1)")
plot_model(wintermod48, title="Winter SSF48 Coefficients (top 1)")
plot_model(summermod48, title="Summer SSF48 Coefficients (top 1)")
plot_model(buneamod50, title="Bunea SSF50 Coefficients (top 1)")
plot_model(buneaImod51, title="Bunea I SSF51 Coefficients (top 1)")
plot_model(buneaIImod40, title="Bunea II SSF40 Coefficients (top 1)")
plot_model(lerestimod50, title="Leresti SSF50 Coefficients (top 1)")
plot_model(lerestiImod48, title="Leresti I SSF48 Coefficients (top 1)")
plot_model(lerestiIImod53, title="Leresti II SSF48 Coefficients (top 1)")
plot_model(premod48, title="Pre 1 year SSF48 Coefficients (top 1)")
plot_model(postmod48, title="Post 1 year SSF48 Coefficients (top 1)")
#summaries
summary(mod48)
summary(wintermod48)
summary(summermod48)
summary(buneamod50)
summary(lerestimod50)
summary(premod48)
summary(postmod48)
#changing font size
plotORwinter <- plot_model(wintermod48, 
                   title = "Winter top model coefficients ")
```
AIC table
```{r AIC table}
modseltop <- modsel[rownames(modsel) %in% c("mod48", "mod49", "mod38", "mod39", "mod50"), ]
View(modseltop)
wintermodseltop <- wintermodsel[rownames(wintermodsel) %in% c("wintermod48", "wintermod52", "wintermod38", "wintermod47", "wintermod51"), ]
summermodseltop <- summermodsel[rownames(summermodsel) %in% c("summermod48", "summermod52", "summermod38", "summermod46", "summermod47"), ]
buneamodseltop <- buneamodsel[rownames(buneamodsel) %in% c("buneamod50", "buneamod46", "buneamod36", "buneamod48", "buneamod52"), ]
buneaImodseltop <- buneaImodsel[rownames(buneaImodsel) %in% c("buneaImod50", "buneaImod46", "buneaImod40", "buneaImod51", "buneaImod53"), ]
buneaIImodseltop <- buneaIImodsel[rownames(buneaImodsel) %in% c("buneaIImod40", "buneaIImod50", "buneaIImod46", "buneaIImod51", "buneaIImod47"), ]
lerestimodseltop <- lerestimodsel[rownames(lerestimodsel) %in% c("lerestimod50", "lerestimod46", "lerestimod36", "lerestimod48", "lerestimod52"), ]
lerestiImodseltop <- lerestiImodsel[rownames(lerestiImodsel) %in% c("lerestiImod48", "lerestiImod52", "lerestiImod53", "lerestiImod49", "lerestiImod38"), ]
lerestiIImodseltop <- lerestiIImodsel[rownames(lerestiIImodsel) %in% c("lerestiIImod48", "lerestiIImod52", "lerestiIImod53", "lerestiIImod49", "lerestiIImod38"), ]
premodseltop <- premodsel[rownames(premodsel) %in% c("premod48", "premod52", "premod38", "premod49", "premod47"), ]
postmodseltop <- postmodsel[rownames(postmodsel) %in% c("postmod48", "postmod52", "postmod38", "postmod49", "postmod47"), ]
# Extract relevant columns
allAICtable <- modseltop[, c("df", "logLik", "AICc", "delta", "weight")]
winterAICtable <- wintermodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
summerAICtable <- summermodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
buneaAICtable <- buneamodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
buneaIAICtable <- buneaImodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
buneaIIAICtable <- buneaIImodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
lerestiAICtable <- lerestimodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
lerestiIAICtable <- lerestiImodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
lerestiIIAICtable <- lerestiIImodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
preAICtable <- premodseltop[, c("df", "logLik", "AICc", "delta", "weight")]
postAICtable <- postmodseltop[, c("df", "logLik", "AICc", "delta", "weight")]

# Create a new data frame
#AICctable <- as.data.frame(postAICtable)
combined_AICc <- do.call(rbind, list(allAICtable, winterAICtable,summerAICtable, buneaAICtable, buneaIAICtable, buneaIIAICtable,lerestiAICtable, lerestiIAICtable, lerestiIIAICtable, preAICtable, postAICtable))
#display the table
print(combined_AICc)
#keep only top 5 models for each subset 
combined_AICc <- combined_AICc[rownames(combined_AICc) %in% c("mod48", "mod49", "mod38", "mod39", "mod50", "wintermod48","wintermod52","wintermod38","wintermod47","wintermod51","summermod48","summermod52","summermod38","summermod46","summermod47","buneamod50", "buneamod46","buneamod36","buneamod48","buneamod52","buneaImod50","buneaImod46","buneaImod40","buneaImod51","buneaImod53", "buneaIImod40","buneaIImod50","buneaIImod46","buneaIImod51","buneaIImod47","buneaIIImod18","buneaIIImod7","buneaIIImod37","buneaIIImod31","buneaIIImod51","lerestimod50","lerestimod46","lerestimod36","lerestimod48","lerestimod52","lerestiImod48","lerestiImod52","lerestiImod53","lerestiImod49","lerestiImod38","lerestiIImod53","lerestiIImod49","lerestiIImod48","lerestiIImod52","lerestiIImod39","premod48","premod52","premod38","premod49","premod47","postmod48","postmod52","postmod38","postmod49","postmod47"), ]

# Checking the selected rows
print(combined_AICc)
#Add ronames
library(tibble)

# Adding row names as a new column
combined_AICc <- rownames_to_column(combined_AICc, var = "Model")
print(combined_AICc)
#export
library(openxlsx)
write.xlsx(combined_AICc, "/Users/lucyholland/Desktop/Lucy/GPS data (NEW)/combined_AICc.xlsx", rowNames = FALSE)
```
Formatting
```{r}
library(rempsyc)
pkgs <- c("flextable", "broom", "report", "effectsize")
install_if_not_installed(pkgs)
#table
nice_table(
  combined_AICc[,1:6 ],
  title = c("Table 1", "AIC output for the top 5 models in each subset"),
  note = c(
    "All data alongside seasonal, herd and pre-/post-release subsets."
  )
)
```

```{r}
predict(mod48)

summary(premod48)
summary(postmod48)
summary(mod48)
summary(wintermod48)
summary(summermod48)
```





